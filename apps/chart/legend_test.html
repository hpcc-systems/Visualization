<!DOCTYPE html>
<html>

<head>
    <title>Legend Testing</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/util'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/common'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/api'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/dataflow'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/chart'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/html'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/dgrid-shim'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/dgrid'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/layout'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/composite'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/phosphor-shim'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/phosphor'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/codemirror-shim'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/codemirror'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/graph'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/map'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/other'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/preact-shim'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/react'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/timeline'></script>
    <script src='https://cdn.jsdelivr.net/npm/@hpcc-js/tree'></script> -->
    <script src='../../packages/util/dist/index.js'></script>
    <script src='../../packages/common/dist/index.js'></script>
    <script src='../../packages/api/dist/index.js'></script>
    <script src='../../packages/chart/dist/index.js'></script>
    <script src='../../packages/dgrid-shim/dist/index.js'></script>
    <script src='../../packages/dgrid/dist/index.js'></script>
    <script src='../../packages/layout/dist/index.js'></script>
    <script src='../../packages/html/dist/index.js'></script>
    <script src='../../packages/composite/dist/index.js'></script>
    <script src='../../packages/phosphor-shim/dist/index.js'></script>
    <script src='../../packages/phosphor/dist/index.js'></script>
    <script src='../../packages/codemirror-shim/dist/index.js'></script>
    <script src='../../packages/codemirror/dist/index.js'></script>
    <script src='../../packages/graph/dist/index.js'></script>
    <script src='../../packages/map/dist/index.js'></script>
    <script src='../../packages/other/dist/index.js'></script>
    <script src='../../packages/preact-shim/dist/index.js'></script>
    <script src='../../packages/react/dist/index.js'></script>
    <script src='../../packages/timeline/dist/index.js'></script>
    <script src='../../packages/tree/dist/index.js'></script>
    <script>
        window.hpccjs = Object.keys(window).filter(n => n.indexOf('@hpcc-js/') === 0).reduce((o, n) => {
            o[n.split('/')[1]] = window[n];
            return o;
        }, {});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/faker@5.4.0/dist/faker.js"></script>
</head>

<body>
</body>

</html>
<script>
    
    [...Array(25)].forEach((n,i)=>{
        const div = document.createElement('div');
        div.id = `div_${i}`;
        div.style.border = `1px solid black`;
        div.style.margin = `4px`;
        div.style.padding = `4px`;
        const r1 = faker.random.number({min:3, max: 6});
        const r2 = faker.random.number({min:3, max: 6});
        div.style.width = `${r1}00px`;
        div.style.height = `${r2}00px`;
        div.style.float = `left`;
        document.body.appendChild(div);

        createChart(
            div.id,
            [
                "Category",
                faker.company.catchPhrase(),
                faker.company.catchPhrase(),
                faker.company.catchPhrase(),
                faker.company.catchPhrase(),
                faker.company.catchPhrase(),
                faker.company.catchPhrase(),
                faker.company.catchPhrase(),
                faker.company.catchPhrase(),
                faker.company.catchPhrase(),
                faker.company.catchPhrase(),
                faker.company.catchPhrase(),
            ],
            [...Array(20)].map((n2,i2)=>{
                return [
                    faker.company.companyName(),
                    faker.random.number({min:30, max: 50}),
                    faker.random.number({min:30, max: 50}),
                    faker.random.number({min:30, max: 50}),
                    faker.random.number({min:30, max: 50}),
                    faker.random.number({min:30, max: 50}),
                    faker.random.number({min:30, max: 50}),
                    faker.random.number({min:30, max: 50}),
                    faker.random.number({min:30, max: 50}),
                    faker.random.number({min:30, max: 50}),
                    faker.random.number({min:30, max: 50}),
                    faker.random.number({min:30, max: 50}),
                ]
            })
        );
    })
    
    function createChart(targetId, columns, data) {

        const legendPosition = faker.random.boolean() ? "right" : "bottom";
        let scrollMode = "vertical";
        if(legendPosition === "bottom"){
            if(faker.random.boolean())scrollMode = "horizontal";
        }

        const columnChart = new hpccjs.chart.Column()
            .xAxisOverlapMode("rotate")
            .xAxisLabelRotation(90)
            .yAxisDomainLow(0)
            .showValueFormat(".0s")
            ;
        const cp = new hpccjs.layout.ChartPanel()
            .widget(columnChart)
            .target(targetId)
            .columns(columns)
            .data(data)
            .legendPosition(legendPosition)
            .downloadImageButtonVisible(true)
            .legendVisible(true)
            .legend_labelMaxWidth(200)
            .legend_legendSize(90)
            .legend_showSeriesTotal(true)
            .legend_showLegendTotal(true)
            .legend_scrollMode(scrollMode)
            .legend_showAltTextOnHover(true)
            .render()
            ;
        return cp;
    }
</script>