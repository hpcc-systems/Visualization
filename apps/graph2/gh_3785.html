<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Tech Tree</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Faker/3.1.0/faker.min.js"></script>


    <script src='../../packages/util/dist/index.js'></script>
    <script src='../../packages/common/dist/index.js'></script>
    <script src='../../packages/api/dist/index.js'></script>
    <script src='../../packages/dataflow/dist/index.js'></script>
    <script src='../../packages/phosphor-shim/dist/index.js'></script>
    <script src='../../packages/phosphor/dist/index.js'></script>
    <script src='../../packages/html/dist/index.js'></script>
    <script src='../../packages/react/dist/index.js'></script>
    <script src='../../packages/graph/dist/index.js'></script>
    <script src='../../packages/other/dist/index.js'></script>
    <script src='../../packages/dgrid/dist/index.js'></script>
    <script src='../../packages/layout/dist/index.js'></script>
    <script src='../../packages/timeline/dist/index.js'></script>
    <script src='../../packages/codemirror-shim/dist/index.js'></script>
    <script src='../../packages/codemirror/dist/index.js'></script>
    <script src='../../packages/comms/dist/index.js'></script>
    <script src='../../packages/chart/dist/index.js'></script>
    <script src='../../packages/tree/dist/index.js'></script>
    <script src='../../packages/eclwatch/dist/index.js'></script>
    <script>
        window.hpccjs = Object.keys(window).filter(n=>n.indexOf('@hpcc-js/')===0).reduce((o,n)=>{o[n.split('/')[1]]=window[n];return o;},{});
    </script>
    <style>
    #target{
        position: fixed;
        top: 30px;
        right: 0px;
        bottom: 0px;
        left: 0px;
    }
    .common_IconBar{
        display: none;
    }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Faker/3.1.0/faker.min.js"></script>
    <!-- <script src="bostock_data.js"></script> -->
</head>
<body>
    <div id="target"></div>
    <script>

        const seed = parseInt( window.location.search.substr( 1 ) ) || 1;

        console.log('seed === ',seed);

        faker.seed(1);
        
        const graph = new hpccjs.graph.Graph2();

        graph
            .target("target")
            .categories([
                {
                    id: 0,
                    imageChar: "fa-leaf",
                    imageCharFill: "#2ecc71",
                    yOffset: 3
                }
            ])
            .data(random_data())
            .layout("ForceDirected")
            .applyScaleOnLayout(true)
            .forceDirectedRepulsionStrength(-3850)
            .forceDirectedLinkDistance(100)
            .forceDirectedMinDistance(5)
            .forceDirectedMaxDistance(200)
            .forceDirectedForceStrength(0.05)
            .showVertexLabels(false)
            .render()
            ;

        function random_data() {
            const singletons = 5;
            const count = 80;
            const vertices = [];
            const edges = [];
            [...Array(count)].forEach((_, i) => {
                const id = vertices.length;
                vertices.push({
                    id,
                    categoryID: 0,
                    text: faker.name.firstName() + " " + faker.name.lastName(),
                    textFontFamily: "monospace"
                });
                if (i > singletons) {
                    edges.push({
                        id: edges.length,
                        source: vertices[i % 2 ? singletons : singletons + 1],
                        target: vertices[id]
                    });
                    if (faker.random.number({
                            min: 0,
                            max: 100
                        }) < 15) {
                        edges.push({
                            id: edges.length,
                            source: vertices[Math.ceil(Math.sqrt(i))],
                            target: vertices[id]
                        });
                    }
                }
            });
            return {
                vertices,
                edges
            };
        }
    </script>
</body>
</html>