(function(e,t){typeof define=="function"&&define.amd?define(["d3","../common/HTMLWidget","amcharts.funnel"],t):e.amchart_CommonFunnel=t(e.d3,e.common_HTMLWidget,e.AmCharts)})(this,function(e,t,n){function r(){t.call(this),this._tag="div",this._chart={},this._data=undefined,this._columns=undefined,this._valueField=[],this._colors=[]}return r.prototype=Object.create(t.prototype),r.prototype.publish("fontSize",null,"number","Font Size",null,{tags:["Basic","Shared"]}),r.prototype.publish("fontFamily",null,"string","Font Name",null,{tags:["Basic","Shared"]}),r.prototype.publish("fontColor",null,"html-color","Font Color",null,{tags:["Basic","Shared"]}),r.prototype.publish("flip",!0,"boolean","Flip Chart",null,{tags:["Intermediate"]}),r.prototype.publish("reverseDataSorting",!1,"boolean","Reverse Data Sorting",null,{tags:["Intermediate"]}),r.prototype.publish("marginLeft",0,"number","Margin (Left)",null,{tags:["Intermediate"]}),r.prototype.publish("marginRight",0,"number","Margin (Right)",null,{tags:["Intermediate"]}),r.prototype.publish("marginTop",null,"number","Margin (Top)",null,{tags:["Intermediate"]}),r.prototype.publish("marginBottom",null,"number","Margin (Bottom)",null,{tags:["Intermediate"]}),r.prototype.publish("labelPosition","center","set","Label Position",["left","right","center"],{tags:["Intermediate"]}),r.prototype.publish("showScrollbar",!1,"boolean","Show Chart Scrollbar",null,{tags:["Intermediate"]}),r.prototype.publish("startDuration",.3,"number","Start Duration (sec)",null,{tags:["Private"]}),r.prototype.publish("Depth3D",0,"number","3D Depth (px)",null,{tags:["Basic"]}),r.prototype.publish("Angle3D",0,"number","3D Angle (Deg)",null,{tags:["Basic"]}),r.prototype.updateChartOptions=function(){var e=this;this._chart.startDuration=this.startDuration(),this._chart.rotate=this.flip(),this._chart.color=this.fontColor(),this._chart.fontSize=this.fontSize(),this._chart.fontFamily=this.fontFamily(),this.marginLeft()&&(this._chart.marginLeft=this.marginLeft()),this.marginRight()&&(this._chart.marginRight=this.marginRight()),this.marginTop()&&(this._chart.marginTop=this.marginTop()),this.marginBottom()&&(this._chart.marginBottom=this.marginBottom()),this._chart.labelPosition=this.labelPosition(),this.titles=[],this.baloon={},this._chart.titleField=this._columns[0],this._chart.valueField=this._columns[1],this._chart.depth3D=this.Depth3D(),this._chart.angle=this.Angle3D();var t=function(e,t){return e[1]>t[1]?1:-1};return this.reverseDataSorting()&&(t=function(e,t){return e[1]<t[1]?1:-1}),this._data=this._data.sort(t),this._chart.dataProvider=this.formatData(this._data),this._colors=[],this._chart.dataProvider.forEach(function(t,n){e._colors.push(e._palette(n))}),this._chart.colors=this._colors,this.showScrollbar()?this._chart.chartScrollbar.enabled=!0:this._chart.chartScrollbar.enabled=!1,this._chart},r.prototype.formatData=function(e){var t=[],n=this;return e.forEach(function(e){var r={};n._columns.forEach(function(t,n){r[t]=e[n]}),t.push(r)}),t},r.prototype.columns=function(e){if(!arguments.length)return this._columns;var n=t.prototype.columns.apply(this,arguments),r=this;return arguments.length?(this._categoryField=e[0],this._valueField=[],e.slice(1,e.length).forEach(function(e){r._valueField.push(e)}),this._columns=e,this):n},r.prototype.enter=function(e,r){t.prototype.enter.apply(this,arguments);var i={theme:"none",type:"funnel",autoResize:!0,autoMargins:!0,chartScrollbar:{}};this._chart=n.makeChart(e,i)},r.prototype.update=function(e,n){t.prototype.update.apply(this,arguments),e.style.width=this.size().width+"px",e.style.height=this.size().height+"px",this._palette=this._palette.switch(this.paletteID()),this.updateChartOptions(),this._chart.validateNow(),this._chart.validateData()},r});