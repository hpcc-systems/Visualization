(function(e,t){typeof define=="function"&&define.amd?define(["d3","../common/HTMLWidget","amcharts.xy","require","./XYAxis"],t):e.amchart_CommonXY=t(e.d3,e.common_HTMLWidget,e.AmCharts,e.require,e.amchart_XYAxis)})(this,function(e,t,n,r,i){function s(){t.call(this),this._tag="div",this._chart={},this._selected=null,this._selections=[],this._dataUpdated=0,this._prevDataUpdated=-1,this._columnsUpdated=0,this._prevColumnsUpdated=-1,this._xAxis=new i,this._xAxis._owningWidget=this,this._yAxis=new i,this._yAxis._owningWidget=this}return s.prototype=Object.create(t.prototype),s.prototype.constructor=s,s.prototype._class+=" amchart_CommonXY",s.prototype.publish("backwardsCompatible",!0,"boolean","Allow use of old publish parameters"),s.prototype.publish("xAxes",[],"propertyArray","widgets",null,{max:1,tags:["Basic"]}),s.prototype.publish("yAxes",[],"propertyArray","widgets",null,{tags:["Basic"]}),s.prototype.publish("fontSize",11,"number","Font Size",null,{tags:["Basic","Shared"]}),s.prototype.publish("fontFamily","Verdana","string","Font Name",null,{tags:["Basic","Shared","Shared"]}),s.prototype.publish("fontColor","#000000","html-color","Font Color",null,{tags:["Basic","Shared"]}),s.prototype.publish("lineWidth",0,"number","Line Thickness",null,{min:0,max:10,step:1,inputType:"range",tags:["Basic","Shared"]}),s.prototype.publish("lineColor",null,"html-color","Color of the data/content lines",null,{tags:["Basic","Shared"]}),s.prototype.publish("lineOpacity",0,"number","Line Opacity",null,{min:0,max:1,step:.001,inputType:"range",tags:["Basic","Shared"]}),s.prototype.publish("dashedLineStyle",0,"number","",null,{tags:["Advanced","Shared"]}),s.prototype.publish("showScrollbar",!1,"boolean","Chart Scrollbar",null,{tags:["Intermediate"]}),s.prototype.publish("bulletSize",8,"number","Bullet Size",null,{tags:["Intermediate"]}),s.prototype.publish("bulletType","round","set","Bullet Type",["none","round","square","triangleUp","triangleDown","triangleLeft","triangleRight","bubble","diamond"],{tags:["Intermediate"]}),s.prototype.publish("marginLeft",50,"number","Margin (Left)",null,{tags:["Intermediate"]}),s.prototype.publish("marginRight",10,"number","Margin (Right)",null,{tags:["Intermediate"]}),s.prototype.publish("marginTop",20,"number","Margin (Top)",null,{tags:["Intermediate"]}),s.prototype.publish("marginBottom",50,"number","Margin (Bottom)",null,{tags:["Intermediate"]}),s.prototype.publish("selectionColor","#f00","html-color","Font Color",null,{tags:["Basic"]}),s.prototype.publish("selectionMode","simple","set","Selection Mode",["simple","multi"],{tags:["Intermediate"]}),s.prototype.publish("showCursor",!1,"boolean","Show Chart Scrollbar",null,{tags:["Intermediate","Shared"]}),s.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),s.prototype.publishProxy("xAxisType","_xAxis","axisType"),s.prototype.publishProxy("yAxisType","_yAxis","axisType"),s.prototype.publishProxy("xAxisTitle","_xAxis","axisTitle"),s.prototype.publishProxy("yAxisTitle","_yAxis","axisTitle"),s.prototype.publishProxy("xAxisBaselineColor","_xAxis","axisBaselineColor"),s.prototype.publishProxy("yAxisBaselineColor","_yAxis","axisBaselineColor"),s.prototype.publishProxy("xAxisFontColor","_xAxis","axisFontColor"),s.prototype.publishProxy("yAxisFontColor","_yAxis","axisFontColor"),s.prototype.publishProxy("xAxisTitleFontSize","_xAxis","axisTitleFontSize"),s.prototype.publishProxy("yAxisTitleFontSize","_yAxis","axisTitleFontSize"),s.prototype.publishProxy("xAxisTitleFontColor","_xAxis","axisTitleFontColor"),s.prototype.publishProxy("yAxisTitleFontColor","_yAxis","axisTitleFontColor"),s.prototype.publishProxy("xAxisLabelRotation","_xAxis","axisLabelRotation"),s.prototype.publishProxy("yAxisLabelRotation","_yAxis","axisLabelRotation"),s.prototype.publish("axisLineWidth",1,"number","Thickness of axis",null,{tags:["Intermediate","Shared"]}),s.prototype.publishProxy("xAxisAutoGridCount","_xAxis","axisAutoGridCount"),s.prototype.publishProxy("yAxisAutoGridCount","_yAxis","axisAutoGridCount"),s.prototype.publishProxy("xAxisGridPosition","_xAxis","axisGridPosition"),s.prototype.publishProxy("yAxisGridPosition","_yAxis","axisGridPosition"),s.prototype.publishProxy("xAxisFillAlpha","_xAxis","axisFillAlpha"),s.prototype.publishProxy("yAxisFillAlpha","_yAxis","axisFillAlpha"),s.prototype.publishProxy("xAxisFillColor","_xAxis","axisFillColor"),s.prototype.publishProxy("yAxisFillColor","_yAxis","axisFillColor"),s.prototype.publishProxy("xAxisGridAlpha","_xAxis","axisGridAlpha"),s.prototype.publishProxy("yAxisGridAlpha","_yAxis","axisGridAlpha"),s.prototype.publishProxy("xAxisDashLength","_xAxis","axisDashLength"),s.prototype.publishProxy("yAxisDashLength","_yAxis","axisDashLength"),s.prototype.publishProxy("xAxisTickFormat","_xAxis","axisTickFormat"),s.prototype.publishProxy("yAxisTickFormat","_yAxis","axisTickFormat"),s.prototype.publish("axisAlpha",1,"number","Axis opacity",null,{tags:["Intermediate"]}),s.prototype._origBackwardsCompatible=s.prototype.backwardsCompatible,s.prototype.backwardsCompatible=function(e){var t=s.prototype._origBackwardsCompatible.apply(this,arguments);return arguments.length&&this.switchProperties(e),t},s.prototype.switchProperties=function(e){e===!0?s.prototype.excludeObjs=["amchart_XYAxis"]:s.prototype.excludeObjs=[]},s.prototype.xAxis=function(e){if(!this.xAxes()[e]){var t=new i;t._owningWidget=this,this.xAxes()[e]=t}return this.xAxes()[e]},s.prototype.yAxis=function(e){if(!this.yAxes()[e]){var t=new i;t._owningWidget=this,this.yAxes()[e]=t}return this.yAxes()[e]},s.prototype.updateChartOptions=function(){var t=this;this._chart.theme="none",this._chart.type="xy",this._chart.color=this.fontColor(),this._chart.fontSize=this.fontSize(),this._chart.fontFamily=this.fontFamily();var n=0;for(var r=0;r<this.yAxes().length;r++){var i=this.yAxes()[r];this._chart.valueAxes[n].position=i.position()?i.position():"left",this._chart.valueAxes[n].axisAlpha=i.axisAlpha(),this._chart.valueAxes[n].title=i.axisTitle(),this._chart.valueAxes[n].axisThickness=i.axisLineWidth(),this._chart.valueAxes[n].axisColor=i.axisBaselineColor(),this._chart.valueAxes[n].color=i.axisFontColor(),this._chart.valueAxes[n].titleFontSize=i.axisTitleFontSize(),this._chart.valueAxes[n].titleColor=i.axisTitleFontColor(),this._chart.valueAxes[n].autoGridCount=i.axisAutoGridCount(),this._chart.valueAxes[n].gridPosition=i.axisGridPosition(),this._chart.valueAxes[n].fillAlpha=i.axisFillAlpha(),this._chart.valueAxes[n].fillColor=i.axisFillColor(),this._chart.valueAxes[n].gridAlpha=i.axisGridAlpha(),this._chart.valueAxes[n].dashLength=i.axisDashLength(),this._chart.valueAxes[n].labelFunction=function(t){return e.format(i.axisTickFormat())(t)},n++}for(var s=0;s<this.xAxes().length;s++){var o=this.xAxes()[s];this._chart.valueAxes[n].position=o.position()?o.position():"bottom",this._chart.valueAxes[n].axisAlpha=o.axisAlpha(),this._chart.valueAxes[n].title=o.axisTitle(),this._chart.valueAxes[n].axisThickness=o.axisLineWidth(),this._chart.valueAxes[n].axisColor=o.axisBaselineColor(),this._chart.valueAxes[n].color=o.axisFontColor(),this._chart.valueAxes[n].titleFontSize=o.axisTitleFontSize(),this._chart.valueAxes[n].titleColor=o.axisTitleFontColor(),this._chart.valueAxes[n].labelRotation=o.axisLabelRotation(),this._chart.valueAxes[n].autoGridCount=o.axisAutoGridCount(),this._chart.valueAxes[n].gridPosition=o.axisGridPosition(),this._chart.valueAxes[n].fillAlpha=o.axisFillAlpha(),this._chart.valueAxes[n].fillColor=o.axisFillColor(),this._chart.valueAxes[n].gridAlpha=o.axisGridAlpha(),this._chart.valueAxes[n].dashLength=o.axisDashLength(),o.axisType()==="ordinal"?(this._chart.valueAxes[n].integersOnly=!0,this._chart.valueAxes[n].labelFunction=function(e,n){return n>t.data().length?"":t.data().length&&n>0?t.data()[n-1][0]:""}):this._chart.valueAxes[n].labelFunction=function(t){return e.format(o.axisTickFormat())(t)},n++}if(this._dataUpdated>this._prevDataUpdated||this._columnsUpdated>this._prevColumnsUpdated)this._chart.dataProvider=this.formatData(this.data());return this._prevDataUpdated=this._dataUpdated,this._prevColumnsUpdated=this._columnsUpdated,this._chart.dataProvider.forEach(function(e,n){t._chart.dataProvider[n].color=t._palette(e[t.columns()[2]]),t._chart.dataProvider[n].linecolor=t.lineColor()!==null?t.lineColor():t._palette(e[t.columns()[2]])}),this._chart.colors=[],this.showScrollbar()?this._chart.chartScrollbar.enabled=!0:this._chart.chartScrollbar.enabled=!1,this.showCursor()?(this._chart.precision=this.xAxes()[0].axisType()==="ordinal"?1:undefined,this._chart.chartCursor.enabled=!0,this._chart.chartCursor.valueLineEnabled=!0,this._chart.chartCursor.valueLineBalloonEnabled=!0,this._chart.chartCursor.categoryBalloonEnabled=!0):(this._chart.precision=undefined,this._chart.chartCursor.enabled=!1,this._chart.chartCursor.valueLineEnabled=!1,this._chart.chartCursor.valueLineBalloonEnabled=!1,this._chart.chartCursor.categoryBalloonEnabled=!1),this._chart},s.prototype.buildGraphObj=function(e,t){var n=this,r={};return r.id="g"+t,r.balloonFunction=function(e){var t=n.columns()[e.graph.index]+": "+n.data()[e.index][e.graph.index];return t},r.lineAlpha=n.lineOpacity(),r.lineThickness=n.lineWidth(),r.bullet=n.bulletType(),r.bulletSize=n.bulletSize(),r.dashLength=n.dashedLineStyle(),r.lineAlpha=n.lineOpacity(),r.lineColor=n.lineColor(),r.lineThickness=n.lineWidth(),r.type=e,r.colorField="color"+t,r.lineColorField="linecolor",this.xAxes()[0].axisType()==="ordinal"&&(r.xField="idx",r.yField=n.columns()[t]),this.xAxes()[0].axisType()==="linear"&&(r.xField=n.columns()[0],r.yField=n.columns()[1]),r},s.prototype.formatData=function(e){var t=this,n=[];return e.forEach(function(e,r){var i={};t.columns().forEach(function(t,n){i[t]=e[n],i.idx=r+1}),n.push(i)}),n},s.prototype.enter=function(e,i){t.prototype.enter.apply(this,arguments),this.xAxes().length===0&&this.xAxes().push(this._xAxis),this.yAxes().length===0&&this.yAxes().push(this._yAxis);var s=this,o={type:"xy",addClassNames:!0,autoMargins:!0,chartScrollbar:{},valueAxes:[],chartCursor:{enabled:!1,valueLineEnabled:!1,valueLineBalloonEnabled:!1,categoryBalloonEnabled:!1,cursorAlpha:0,valueLineAlpha:.2,oneBalloonOnly:!0,balloonPointerOrientation:"vertical",valueBalloonsEnabled:!1},graphs:[{}],dataProvider:[{}],responsive:{enabled:!0}};typeof define=="function"&&define.amd&&(o.pathToImages=r.toUrl("amchartsImg")),this._chart=n.makeChart(e,o),this._chart.addListener("clickGraphItem",function(e){var t=e.graph,n=e.item.dataContext,r=t.colorField;n[r]!==null&&n[r]!==undefined?(delete n[r],s.selectionMode()==="simple"&&(s._selected!==null&&delete s._selected.data[s._selected.field],s._selected=null)):(n[r]=s.selectionColor(),s.selectionMode()==="simple"&&(s._selected!==null&&delete s._selected.data[s._selected.field],s._selected={field:r,data:n,cIdx:e.target.index,dIdx:e.index},s._selections.push(s._selected))),e.chart.validateData(),s.click(s.rowToObj(s.data()[e.index]),s.columns()[e.target.index],s._selected!==null)})},s.prototype.update=function(e,n){t.prototype.update.apply(this,arguments),this.backwardsCompatible()?this.switchProperties(!0):this.switchProperties(!1),e.style.width=this.size().width+"px",e.style.height=this.size().height+"px",this._palette=this._palette.switch(this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()))},s.prototype.render=function(e){return t.prototype.render.apply(this,arguments)},s.prototype.data=function(e){return arguments.length&&this._dataUpdated++,t.prototype.data.apply(this,arguments)},s.prototype.columns=function(e){return arguments.length&&this._columnsUpdated++,t.prototype.columns.apply(this,arguments)},s});