(function(e,t){typeof define=="function"&&define.amd?define(["d3","../common/HTMLWidget","../common/Utility","d3-bullet","css!./Bullet"],t):e.chart_Bullet=t(e.d3,e.common_HTMLWidget,e.common_Utility,e.d3.bullet)})(this,function(e,t,n,r){function i(e){t.call(this),n.SimpleSelectionMixin.call(this,!0)}return r=r||e.bullet||window.d3.bullet,i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" chart_Bullet",i.prototype.publish("titleColumn",null,"set","Title Column",function(){return this.columns()},{optional:!0}),i.prototype.publish("subtitleColumn",null,"set","Subtitle Column",function(){return this.columns()},{optional:!0}),i.prototype.publish("rangesColumn",null,"set","Ranges Column",function(){return this.columns()},{optional:!0}),i.prototype.publish("measuresColumn",null,"set","Measures Column",function(){return this.columns()},{optional:!0}),i.prototype.publish("markersColumn",null,"set","Markers Column",function(){return this.columns()},{optional:!0}),i.prototype.bulletData=function(){function t(t,n){var r=e.indexOf(n);return r>=0?t[r]instanceof Array?t[r]:[t[r]]:[]}var e=this.columns();return this.data().map(function(e){return{title:t(e,this.titleColumn()),subtitle:t(e,this.subtitleColumn()),ranges:t(e,this.rangesColumn()),measures:t(e,this.measuresColumn()),markers:t(e,this.markersColumn()),origRow:e}},this)},i.prototype.enter=function(n,r){t.prototype.enter.apply(this,arguments),e.select(n.parentNode).style("overflow","auto"),this._selection.widgetElement(r)},i.prototype.update=function(n,i){t.prototype.update.apply(this,arguments);var s=this,o={top:8,right:16,bottom:20,left:16},u=this.width()-o.left-o.right,a=50-o.top-o.bottom,f=i.selectAll("svg").data(this.bulletData());f.enter().append("svg").attr("class","bullet").call(this._selection.enter.bind(this._selection)).on("click",function(e){s.click(s.rowToObj(e.origRow),s.titleColumn(),s._selection.selected(this))}).each(function(t){var n=e.select(this),r=n.append("g").attr("class","bulletBar"),i=r.append("g").attr("class","bulletTitle");i.append("text").attr("class","title"),i.append("text").attr("class","subtitle").attr("dy","1em")});var l=f.select(".bulletTitle").style("text-anchor","end").attr("transform","translate(-6,"+a/2+")");l.select(".title").text(function(e){return e.title}),l.select(".subtitle").text(function(e){return e.subtitle});var c=0;l.each(function(){var e=this.getBBox();e.width>c&&(c=e.width)});var h=(new r).width(u-c).height(a);f.attr("width",u).attr("height",a+o.top+o.bottom),f.select(".bulletBar").attr("transform","translate("+(c+o.left)+","+o.top+")").call(h),f.exit().remove()},i.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},i.prototype.click=function(e,t,n){console.log("Click:  "+JSON.stringify(e)+", "+t+","+n)},i});