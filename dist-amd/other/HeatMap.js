(function(e,t){typeof define=="function"&&define.amd?define(["d3","../common/CanvasWidget","simpleheat","../common/Palette"],t):e.other_HeatMap=t(e.d3,e.common_CanvasWidget,e.simpleheat,e.common_Palette)})(this,function(e,t,n,r){function i(){t.call(this)}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._palette=r.rainbow("default"),i.prototype._class+=" other_HeatMap",i.prototype.publish("radius",15,"number","Set point radius",null,{tags:["Basic"]}),i.prototype.publish("blur",15,"number","Set point blur",null,{tags:["Basic"]}),i.prototype.publish("max",1,"number","Set max data value",null,{tags:["Basic"]}),i.prototype.publish("gradient",{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},"object","Set gradient colors",null,{tags:["Basic"]}),i.prototype.publish("usePalette",!1,"boolean","If true, uses paletteID and colorCount to determine gradient",null,{tags:["Basic"]}),i.prototype.publish("colorCount",10,"number","Top left x-value",null,{tags:["Basic"]}),i.prototype.publish("paletteID","default","set","Palette ID",i.prototype._palette.switch(),{tags:["Basic"]}),i.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),i.prototype.publish("topLeftX",null,"number","Top left x-value",null,{tags:["Basic"]}),i.prototype.publish("topLeftY",null,"number","Top left y-value",null,{tags:["Basic"]}),i.prototype.publish("bottomRightX",null,"number","Bottom right x-value",null,{tags:["Basic"]}),i.prototype.publish("bottomRightY",null,"number","Bottom right y-value",null,{tags:["Basic"]}),i.prototype.enter=function(e,r){t.prototype.enter.apply(this,arguments),this.resize(this._size),this._heat=n(e)},i.prototype.update=function(e,n){t.prototype.update.apply(this,arguments),this._palette=this._palette.switch(this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id())),this.topLeftX()!==null&&this.topLeftY()!==null&&this.bottomRightX()!==null&&this.bottomRightY()!==null?this._heat.data(this.skewedData()):this._heat.data(this.data()),this.radius()&&this._heat.radius(this.radius(),this.blur());if(this.usePalette()){var r={};for(var i=1;i<=this.colorCount();i++){var s=i/this.colorCount();r[s]=this._palette(i,1,this.colorCount())}this._heat.defaultGradient=r,this._heat.gradient(r)}else this.gradient()&&(this._heat.defaultGradient=this.gradient(),this._heat.gradient(this.gradient()));this._heat.draw()},i.prototype.exit=function(e,n){delete this._heat,t.prototype.exit.apply(this,arguments)},i.prototype.resize=function(e){t.prototype.resize.apply(this,arguments),this._heat!==undefined&&this._heat.resize()},i.prototype.skewedData=function(){var e=this,t=[],n=this.data(),r=this.element().node().getBoundingClientRect(),i=this.bottomRightX()-this.topLeftX(),s=this.bottomRightY()-this.topLeftY(),o=i/r.width,u=s/r.height;return n.forEach(function(n){var r=Math.abs(n[0]-e.topLeftX()),i=Math.abs(n[1]-e.topLeftY()),s=r/o,a=i/u;t.push([s,a,n[2]])}),t},i});