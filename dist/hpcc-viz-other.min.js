(function(e,t){typeof define=="function"&&define.amd?define("other/Audio.js",["d3","../common/HTMLWidget"],t):e.other_Audio=t(e.d3,e.common_HTMLWidget)})(this,function(e,t){function n(){t.call(this),this._tag="audio",this._sections={}}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" other_Audio",n.prototype.publish("source","","string","Audio Source"),n.prototype.section=function(e,t,n,r){return arguments.length?arguments.length===1?this._sections[e]:(this._sections[e]={label:e,offset:t,beatLength:n,beatCount:r,endOffset:t+r*n},this):this._sections},n.prototype.getType=function(e){switch(e){case"mp3":return"audio/mpeg; codecs='mp3'";case"ogg":return"audio/ogg; codecs='vorbis'"}return""},n.prototype.enter=function(e,t){var n=this;t.on("play",function(e){n.onPlay(e)})},n.prototype.update=function(e,t){var n=t.selectAll("source").data(this.source(),function(e){return e});n.enter().append("source").attr("src",function(e){return e})},n.prototype.createTimer=function(t,n,r){var i=this;e.timer(function(){return i.onTick(t.label,r,t),!0},r*t.beatLength,n+t.offset)},n.prototype.onTick=function(e,t,n){},n.prototype.onPlay=function(e){var t=Date.now();for(var n in this._sections){var r=this._sections[n];for(var i=0;i<r.beatCount;++i)this.createTimer(r,t,i)}},n.prototype.play=function(e){var t=this;this._element.on("canplaythrough",function(e){t.node().play()}),this.node().load()},n}),function(e,t){typeof define=="function"&&define.amd?define("other/Comms.js",[],t):e.other_Comms=t()}(this,function(){function e(e){if(!e.trim)return e;var t=e.trim();return t!==""&&!isNaN(t)?Number(t):t}function t(t){for(var n in t)t[n]=e(t[n]);return t}function n(){this._protocol="http:",this._hostname="localhost"}function r(e){this._mappings=e,this._reverseMappings={};for(var t in this._mappings){this._reverseMappings[t]={};for(var n in this._mappings[t])this._reverseMappings[t][this._mappings[t][n]]=n}}function i(){n.call(this),this._proxyMappings={},this._mappings=new r({})}function s(e,t){var n=e.split("."),r=t;for(var i=0;i<n.length;++i){var s=n[i];if(r[s]===undefined)return!1;r=r[s]}return!0}function u(){i.call(this)}function a(){i.call(this),this._port="8002",this._target="",this._query=""}function f(){i.call(this),this._port="8010",this._wuid="",this._jobname="",this._sequence=null,this._resultName=null,this._resultNameCache={},this._resultNameCacheCount=0}function l(){i.call(this),this._port="8010",this._wuid=null}function c(){i.call(this)}function h(){f.call(this),this._hipieResults={}}function p(){h.call(this)}n.prototype.url=function(e){if(!arguments.length)return this._url;this._url=e;var t=document.createElement("a");t.href=this._url;var n={};if(t.search.length){var r=t.search;r[0]==="?"&&(r=r.substring(1)),r=r.split("&"),r.map(function(e){var t=e.split("=");n[decodeURIComponent(t[0])]=decodeURIComponent(t[1])})}this._protocol=t.protocol,this._hostname=t.hostname,this._port=t.port,this._pathname=t.pathname;while(this._pathname.length&&this._pathname[0]==="/")this._pathname=this._pathname.substring(1);return this._search=t.search,this._params=n,this._hash=t.hash,this._host=t.host,this},n.prototype.protocol=function(e){return arguments.length?(this._protocol=e,this):this._protocol},n.prototype.hostname=function(e){return arguments.length?(this._hostname=e,this):this._hostname},n.prototype.port=function(e){return arguments.length?(this._port=e,this):this._port},n.prototype.pathname=function(e){return arguments.length?(this._pathname=e,this):this._pathname},n.prototype.isWsWorkunits=function(){return this._pathname.toLowerCase().indexOf("wsworkunits")>=0||this._params.Wuid},n.prototype.isWorkunitResult=function(){return this.isWsWorkunits()&&(this._params.Sequence||this._params.ResultName)},n.prototype.isWsEcl=function(){return this._pathname.toLowerCase().indexOf("wsecl")>=0||this._params.QuerySetId&&this._params.Id},n.prototype.isWsWorkunits_GetStats=function(){return this._pathname.toLowerCase().indexOf("wsworkunits/wugetstats")>=0&&this._params.WUID},n.prototype.getUrl=function(e){return e=e||{},(e.protocol?e.protocol:this._protocol)+"//"+(e.hostname?e.hostname:this._hostname)+":"+(e.port?e.port:this._port)+"/"+(e.pathname?e.pathname:this._pathname)},r.prototype.contains=function(e,t){return s(e+"."+t,this._mappings)},r.prototype.mapResult=function(e,t){var n=this._mappings[t];n&&(e[t]=e[t].map(function(e){var t=[];if(n.x&&n.x instanceof Array){t=[];for(var r=0;r<n.x.length;++r)t.push(e[n.y[r]])}else for(var i in n)n[i]==="label"?t[0]=e[i]:n[i]==="weight"&&(t[1]=e[i]);return t},this))},r.prototype.mapResponse=function(e){for(var t in e)this.mapResult(e,t)},i.prototype=Object.create(n.prototype);var o=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")};return i.prototype.jsonp=function(e,t,r){function d(e){delete window[c],document.body.removeChild(h),r(e)}for(var i in this._proxyMappings){var s=e.split(i),u=s[0];if(s.length>1){var a=(new n).url(e);e=u+this._proxyMappings[i],t.IP=a._hostname,t.PORT=a._port,s.length>0&&(t.PATH=s[1]);break}}var f=6e4,l=5e3,c="jsonp_callback_"+Math.round(Math.random()*999999);window[c]=function(e){f=0,d(e)};var h=document.createElement("script");h.src=e+(e.indexOf("?")>=0?"&":"?")+"jsonp="+c+"&"+o(t),document.body.appendChild(h);var p=setInterval(function(){f<=0?clearInterval(p):(f-=l,f<=0?(clearInterval(p),console.log("Request timeout:  "+h.src),d()):console.log("Request pending ("+f/1e3+" sec):  "+h.src))},l)},i.prototype.mappings=function(e){return arguments.length?(this._mappings=new r(e),this):this._mappings},i.prototype.proxyMappings=function(e){return arguments.length?(this._proxyMappings=e,this):this._proxyMappings},u.prototype=Object.create(i.prototype),u.prototype.cacheCalls=function(e){return arguments.length?(this._cacheCalls=e,this):this._cacheCalls},u.prototype.call=function(e,t){function r(e,t){var r=new XMLHttpRequest;r.open("GET",n,!0),r.onload=function(e){t(JSON.parse(r.responseText))},r.onerror=function(e){t({})},r.send(null)}var n=this._url+(this._url.indexOf("?")>=0?"&":"?")+o(e);if(this._cacheCalls){var i=localStorage.getItem("hpcc.viz."+n);i&&i!==null?setTimeout(function(){t(JSON.parse(i))},0):r(e,function(e){localStorage.setItem("hpcc.viz."+n,JSON.stringify(e)),t(e)})}else localStorage.removeItem("hpcc.viz."+n),r(e,t)},a.prototype=Object.create(i.prototype),a.prototype.url=function(e){var t=i.prototype.url.apply(this,arguments);if(arguments.length){this._port=this._port==="8010"?"8002":this._port;for(var n in this._params)switch(n){case"QuerySetId":this.target(this._params[n]);break;case"Id":this.query(this._params[n])}var r,s;!this._target&&!this._query&&(r=this._pathname.split("/res/"),r.length>=2&&(s=r[1].split("/"),s.length>=3&&(this.target(s[1]),this.query(s[2])))),!this._target&&!this._query&&(r=this._pathname.split("/forms/default/"),r.length>=2&&(s=r[1].split("/"),s.length>=3&&(this.target(s[1]),this.query(s[2]))))}return t},a.prototype.target=function(e){return arguments.length?(this._target=e,this):this._target},a.prototype.query=function(e){return arguments.length?(this._query=e,this):this._query},a.prototype.constructUrl=function(){return i.prototype.getUrl.call(this,{pathname:"WsEcl/submit/query/"+this._target+"/"+this._query+"/json"})},a.prototype.call=function(e,n,r){e=e||{},e.target=e.target||this._target,e.query=e.query||this._query;var i=this,s=this.getUrl({pathname:"WsEcl/submit/query/"+e.target+"/"+e.query+"/json"});this.jsonp(s,n,function(e){for(var n in e){e=e[n].Results;break}for(n in e)e[n]=e[n].Row.map(t);i._mappings.mapResponse(e),r(e)})},a.prototype.send=function(e,t){this.call({target:this._target,query:this._query},e,t)},f.prototype=Object.create(i.prototype),f.prototype.url=function(e){var t=i.prototype.url.apply(this,arguments);if(arguments.length){for(var n in this._params)switch(n){case"Wuid":this.wuid(this._params[n]);break;case"ResultName":this.resultName(this._params[n]);break;case"Sequence":this.sequence(this._params[n])}if(!this._wuid){var r=this._url.split("/res/");if(r.length>=2){var s=r[1].split("/");this.wuid(s[0])}}}return t},f.prototype.wuid=function(e){return arguments.length?(this._wuid=e,this):this._wuid},f.prototype.jobname=function(e){return arguments.length?(this._jobname=e,this):this._jobname},f.prototype.sequence=function(e){return arguments.length?(this._sequence=e,this):this._sequence},f.prototype.resultName=function(e){return arguments.length?(this._resultName=e,this):this._resultName},f.prototype.appendParam=function(e,t,n){return t?(n&&(n+="&"),n+e+"="+t):n},f.prototype.constructUrl=function(){var e=i.prototype.getUrl.call(this,{pathname:"WsWorkunits/res/"+this._wuid+"/"}),t="";return t=this.appendParam("ResultName",this._resultName,t),e+(t?"?"+t:"")},f.prototype._fetchResult=function(e,n,r){e=e||{},e._start=e._start||0,e._count=e._count||-1;var i=this.getUrl({pathname:"WsWorkunits/WUResult.json"}),s={Wuid:e.wuid,ResultName:e.resultname,SuppressXmlSchema:!0,Start:e._start,Count:e._count};this._resultNameCache[e.resultname]={};var o=this;this.jsonp(i,s,function(i){for(var s in i){if(!i[s].Result)throw"No result found.";o._total=i[s].Total,i=i[s].Result;for(var u in i){i=i[u].Row.map(t);break}break}o._resultNameCache[e.resultname]=i,r||o._mappings.mapResult(o._resultNameCache,e.resultname),n(o._resultNameCache[e.resultname])})},f.prototype.fetchResult=function(e,t,n){if(e.wuid)this._fetchResult(e,t,n);else if(e.jobname){var r=this;this.WUQuery(e,function(i){e.wuid=i[0].Wuid,r._fetchResult(e,t,n)})}},f.prototype.WUQuery=function(e,t){var n=this.getUrl({pathname:"WsWorkunits/WUQuery.json"}),r={Jobname:r.jobname,Count:1};this._resultNameCache={},this._resultNameCacheCount=0,this.jsonp(n,r,function(e){if(!s("WUQueryResponse.Workunits.ECLWorkunit",e))throw"No workunit found.";e=e.WUQueryResponse.Workunits.ECLWorkunit,t(e)})},f.prototype.fetchResultNames=function(e){var t=this.getUrl({pathname:"WsWorkunits/WUInfo.json"}),n={Wuid:this._wuid,TruncateEclTo64k:!0,IncludeExceptions:!1,IncludeGraphs:!1,IncludeSourceFiles:!1,IncludeResults:!0,IncludeResultsViewNames:!1,IncludeVariables:!1,IncludeTimers:!1,IncludeResourceURLs:!1,IncludeDebugValues:!1,IncludeApplicationValues:!1,IncludeWorkflows:!1,IncludeXmlSchemas:!1,SuppressResultSchemas:!0};this._resultNameCache={},this._resultNameCacheCount=0;var r=this;this.jsonp(t,n,function(t){s("WUInfoResponse.Workunit.Results.ECLResult",t)&&(t.WUInfoResponse.Workunit.Results.ECLResult.map(function(e){r._resultNameCache[e.Name]=[],++r._resultNameCacheCount}),e(r._resultNameCache))})},f.prototype.fetchResults=function(e,t){var n=this;this.fetchResultNames(function(r){var i=n._resultNameCacheCount;if(i>0)for(var s in n._resultNameCache)n.fetchResult({wuid:n._wuid,resultname:s},function(t){--i<=0&&e(n._resultNameCache)},t);else e(n._resultNameCache)})},f.prototype.postFilter=function(e,t){var n={};for(var r in t)n[r]=t[r].filter(function(t,n){for(var r in e)if(t[r]!==undefined&&e[r]!==undefined&&t[r]!==e[r])return!1;return!0});return this._mappings.mapResponse(n),n},f.prototype.send=function(e,t){var n=this;this._resultNameCacheCount?t(n.postFilter(e,this._resultNameCache)):this.fetchResults(function(r){t(n.postFilter(e,r))},!0)},l.prototype=Object.create(i.prototype),l.prototype.url=function(e){var t=i.prototype.url.apply(this,arguments);if(arguments.length)for(var n in this._params)switch(n){case"WUID":this.wuid(this._params[n])}return t},l.prototype.wuid=function(e){return arguments.length?(this._wuid=e,this):this._wuid},l.prototype.constructUrl=function(){return i.prototype.getUrl.call(this,{pathname:"WsWorkunits/WUGetStats?WUID="+this._wuid})},l.prototype.send=function(e,t){var n=this.getUrl({pathname:"WsWorkunits/WUGetStats.json?WUID="+this._wuid});this.jsonp(n,e,function(e){s("WUGetStatsResponse.Statistics.WUStatisticItem",e)?t(e.WUGetStatsResponse.Statistics.WUStatisticItem):t([])})},c.prototype=Object.create(i.prototype),c.prototype.fetchResults=function(e,n){var r=this.getUrl({});this._resultNameCache={},this._resultNameCacheCount=0;var i=this;this.jsonp(r,e,function(e){for(var r in e){e=e[r].Results;break}for(r in e)i._resultNameCache[r]=e[r].Row.map(t),++i._resultNameCacheCount;n(i._resultNameCache)})},c.prototype.fetchResult=function(e,t){t(this._resultNameCache[e])},c.prototype.call=function(e,t){this.fetchResults(e,t)},h.prototype=Object.create(f.prototype),h.prototype.hipieResults=function(e){if(!arguments.length)return this._hipieResults;this._hipieResultsLength=0,this._hipieResults={};var t=this;return e.forEach(function(e){t._hipieResultsLength++,t._hipieResults[e.id]=e}),this},h.prototype.fetchResults=function(e){var t=this;return f.prototype.fetchResultNames.call(this,function(n){var r=t._hipieResultsLength;if(r>0)for(var i in t._hipieResults){var s=t._hipieResults[i];t.fetchResult(s.from,function(n){--r<=0&&e(t._resultNameCache)})}else e(t._resultNameCache)})},h.prototype.fetchResult=function(e,t){return f.prototype.fetchResult.call(this,{wuid:this._wuid,resultname:e},function(e){t(e)})},h.prototype.call=function(e,t){if(e.refresh||!this._resultNameCache||!this._resultNameCacheCount)this.fetchResults(t);else{var n={};for(var r in e)e[r]&&e[r+"_changed"]!==undefined&&(n[r]=e[r]);var i={};for(var s in this._hipieResults){var o=this._hipieResults[s],u=!0;for(var a in n)if(o.filter.indexOf(a)<0){u=!1;break}u&&(i[o.from]=this._resultNameCache[o.from].filter(function(e){for(var t in n)if(e[t]!==n[t]&&e[t.toLowerCase()]!==n[t])return!1;return!0}))}t(i)}},p.prototype=Object.create(h.prototype),p.prototype.databomb=function(e){return arguments.length?(this._databomb=e.map(t),this):this._databomb},p.prototype.databombOutput=function(e){return arguments.length?(this._resultNameCacheCount++,this._resultNameCache[e]=this._databomb,this):undefined},p.prototype.fetchResults=function(e){var t=this;setTimeout(function(){e(t._resultNameCache)},0)},{Basic:u,ESPMappings:r,ESPUrl:n,WsECL:a,WsWorkunits:f,HIPIERoxie:c,HIPIEWorkunit:h,HIPIEDatabomb:p,createESPConnection:function(e){e=e||document.URL;var t=(new n).url(e);return t.isWsWorkunits_GetStats()?(new l).url(e):t.isWsWorkunits()?(new f).url(e):t.isWsEcl()?(new a).url(e):null}}}),function(e,t){typeof define=="function"&&define.amd?define("other/HeatMap.js",["d3","../common/CanvasWidget","simpleheat"],t):e.other_HeatMap=t(e.d3,e.common_CanvasWidget,e.simpleheat)}(this,function(e,t,n){function r(){t.call(this)}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" other_HeatMap",r.prototype.publish("radius",25,"number","Set point radius",null,{tags:["Basic"]}),r.prototype.publish("blur",15,"number","Set point blur",null,{tags:["Basic"]}),r.prototype.publish("max",1,"number","Set max data value",null,{tags:["Basic"]}),r.prototype.publish("gradient",[],"array","Set gradient colors",null,{tags:["Basic"]}),r.prototype.enter=function(e,r){t.prototype.enter.apply(this,arguments),this.resize(this._size),this._heat=n(e)},r.prototype.update=function(e,n){t.prototype.update.apply(this,arguments),this.data().length===4&&this.data().map(function(e){return e.splice(0,3)}),this._heat.data(this.data()),this.radius()&&this._heat.radius(this.radius(),this.blur()),this._heat.draw()},r.prototype.exit=function(e,n){delete this._heat,t.prototype.exit.apply(this,arguments)},r}),function(e,t){typeof define=="function"&&define.amd?define("other/Image.js",["../common/HTMLWidget"],t):e.other_Image=t(e.common_HTMLWidget)}(this,function(e){function t(){e.call(this),this._tag="img",this._prevSource=undefined}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype._class+=" other_Image",t.prototype.publish("source",null,"string","Image Source",null,{tags:["Basic"]}),t.prototype.publish("sizing","actual","set","Controls sizing mode",["actual","fit","custom"],{tags:["Basic"]}),t.prototype.publish("customWidth","50%","string","Applies this width to IMG element if 'sizing' is set to 'custom'",null,{tags:["Basic"]}),t.prototype.publish("customHeight","20%","string","Applies this height to IMG element if 'sizing' is set to 'custom'",null,{tags:["Basic"]}),t.prototype.publish("lockAspectRatio",!0,"boolean","Locks the aspect ratio when scaling/stretching",null,{tags:["Basic"]}),t.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),n.attr("src",this.source()),this._prevSource=this.source(),this.initSource(n)},t.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this.changedSource()&&this.initSource(n),this.sizing()==="custom"?n.style({width:this.customWidth(),height:this.customHeight()}):this.sizing()==="actual"?n.style({width:"auto",height:"auto"}):this.sizing()==="fit"&&n.style({width:"100%",height:"100%"}),this.lockAspectRatio()&&this.applyAspectRatio(n);var r=n.node().getBoundingClientRect();this._projectScaleY=r.height/this._sourceHeight,this._projectScaleX=r.width/this._sourceWidth},t.prototype.changedSource=function(){return this._prevSource!==this.source()},t.prototype.exit=function(t,n){e.prototype.exit.apply(this,arguments)},t.prototype.initSource=function(e){e.attr("src",this.source()),e.style({width:"auto",height:"auto"}),this._prevSource=this.source(),this._sourceBBox=e.node().getBoundingClientRect(),this._sourceWidth=this._sourceBBox.width,this._sourceHeight=this._sourceBBox.height,this._ratio=this._sourceBBox.width/this._sourceBBox.height},t.prototype.projection=function(e,t){return{x:e*this._projectScaleX,y:t*this._projectScaleY}},t.prototype.applyAspectRatio=function(e){var t=e.node().getBoundingClientRect();t.width<t.height?e.style({height:1/this._ratio*t.width+"px"}):e.style({width:this._ratio*t.height+"px"})},t}),function(e,t){typeof define=="function"&&define.amd?define("other/IWordCloud",[],t):e.other_IWordCloud=t()}(this,function(){function e(){}return e.prototype.click=function(e){console.log("Click:  "+e.label)},e}),typeof define=="function"&&define.amd&&define("css",[],function(){return{load:function(e,t,n){n()}}}),function(e,t){typeof define=="function"&&define.amd?define("other/Paginator.js",["d3","../common/HTMLWidget","css!./Paginator"],t):e.other_Paginator=t(e.d3,e.common_HTMLWidget)}(this,function(e,t){function n(){t.call(this),this._tag="div",this._tNumPages=1,this._numList=[]}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" other_Paginator",n.prototype.publish("itemsPerPage",2,"number","Pagination items per page",null,{tags:["Private"]}),n.prototype.publish("numItems",10,"number","Pagination total number of items",null,{tags:["Private"]}),n.prototype.publish("pageNumber",1,"number","Pagination set or get the page number",null,{tags:["Private"]}),n.prototype.publish("adjacentPages",2,"number","Number of page indexes either side of current one",null,{tags:["Private"]}),n.prototype.publish("bottom",20,"number","Pagination bottom offset",null,{tags:["Private"]}),n.prototype.publish("right",20,"number","Pagination right offset",null,{tags:["Private"]}),n.prototype.postUpdate=function(e,t){},n.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments);var r=this;this.paginator=n.append("ul").attr("class","paginator pagination pagination-sm"),this.side=n.append("div").attr("class","paginator pagination side"),this.side.append("span").classed("side",!0).text("Page "),this.side.append("input").attr("type","number").attr("class","currentPageNumber").property("value",1).attr("min",1).on("change",function(){r.pageNumber(this.value),r._onSelect(this.value)}),this.side.append("span").classed("side total",!0).text(" of 1")},n.prototype.update=function(t,n){var r=this;n.style("bottom",this.bottom()+"px").style("right",this.right()+"px"),this._tNumPages=Math.ceil(this.numItems()/this.itemsPerPage())||1,this.pageNumber()>this._tNumPages&&this.pageNumber(1),this._numList=[];if(this.numItems()){this._numList.push("first");for(var i=-this.adjacentPages();i<=this.adjacentPages();i++)this.pageNumber()+i>0&&this.pageNumber()+i<=this._tNumPages&&this._numList.push(this.pageNumber()+i);this._numList.push("last")}this.side.select(".total").text(" of "+this._tNumPages),this.side.select(".currentPageNumber").property("value",this.pageNumber()),this.side.select(".currentPageNumber").attr("max",this._tNumPages);var s=this.paginator.selectAll("li").data(this._numList,function(e){return e});s.enter().append(function(e){var t=document.createElement("li");if(e!==r.pageNumber()){var n=document.createElement("a"),i=document.createTextNode(e);return n.appendChild(i),n.href="#",t.appendChild(n),t}var s=document.createElement("span");return s.innerHTML=e,t.appendChild(s),t}).on("click",function(t,n){e.event.preventDefault(),r.side.select(".currentPageNumber").property("value",r.pageNumber());switch(t){case"first":r.pageNumber()!==1&&(r.pageNumber(1),r._onSelect(1,"previous"));break;case"last":r.pageNumber()!==r._tNumPages&&(r.pageNumber(r._tNumPages),r._onSelect(r._tNumPages,"previous"));break;default:r.pageNumber(t),r._onSelect(t)}}),s.classed("active",function(e,t){return e===r.pageNumber()}).select("a").text(function(e){return e}),s.exit().remove(),s.order(),this.numItems()===0&&e.select(t).remove()},n.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},n}),function(e,t){typeof define=="function"&&define.amd?define("other/Table.js",["d3","../common/HTMLWidget","./Paginator","../common/Utility","css!./Table"],t):e.other_Table=t(e.d3,e.common_HTMLWidget,e.other_Paginator,e.common_Utility)}(this,function(e,t,n,r){function i(){t.call(this),this._tag="div",this._currentSort="",this._currentSortOrder=1,this.columns([]),this._paginator=new n,this._selectionBag=new r.Selection,this._selectionPrevClick=null,this._paginatorTableSpacing=4}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" other_Table",i.prototype.publish("renderHtmlDataCells",!1,"boolean","enable or disable HTML within cells",null,{tags:["Private"]}),i.prototype.publish("pagination",!1,"boolean","Enable or disable pagination",null,{tags:["Private"]}),i.prototype.publishProxy("itemsPerPage","_paginator"),i.prototype.publishProxy("pageNumber","_paginator","pageNumber",1),i.prototype.publishProxy("adjacentPages","_paginator"),i.prototype.publish("showHeader",!0,"boolean","Show or hide the table header",null,{tags:["Private"]}),i.prototype.publish("fixedHeader",!1,"boolean","Enable or disable fixed table header",null,{tags:["Private"]}),i.prototype.publish("fixedColumn",!1,"boolean","Enable or disable fixed first column",null,{tags:["Private"]}),i.prototype.publish("fixedSize",!1,"boolean","Fix Size to Min Width/Height"),i.prototype.publish("theadFontSize",null,"string","Table head font size",null,{tags:["Basic"],optional:!0}),i.prototype.publish("tbodyFontSize",null,"string","Table body font size",null,{tags:["Basic"],optional:!0}),i.prototype.publish("theadFontColor",null,"html-color","Table head font color",null,{tags:["Basic"],optional:!0}),i.prototype.publish("tbodyFontColor",null,"html-color","Table body font color",null,{tags:["Basic"],optional:!0}),i.prototype.publish("theadFontFamily",null,"string","Table head font family",null,{tags:["Basic"],optional:!0}),i.prototype.publish("tbodyFontFamily",null,"string","Table body font family",null,{tags:["Basic"],optional:!0}),i.prototype.publish("theadCellBorderColor",null,"html-color","Table head cell border color",null,{tags:["Basic"],optional:!0}),i.prototype.publish("theadRowBackgroundColor",null,"html-color","Table head row color",null,{tags:["Basic"],optional:!0}),i.prototype.publish("tbodyCellBorderColor",null,"html-color","Table body cell border color",null,{tags:["Basic"],optional:!0}),i.prototype.publish("tbodyRowBackgroundColor",null,"html-color","Table body row color",null,{tags:["Basic"],optional:!0}),i.prototype.publish("tbodyFirstColFontColor",null,"html-color","Table body first column font color",null,{tags:["Basic"],optional:!0}),i.prototype.publish("tbodyFirstColBackgroundColor",null,"html-color","Table body first column background color",null,{tags:["Basic"],optional:!0}),i.prototype.publish("tbodyHoverRowFontColor",null,"html-color","Table body hover row font color",null,{tags:["Basic"],optional:!0}),i.prototype.publish("tbodyHoverRowBackgroundColor",null,"html-color","Table body hover row background color",null,{tags:["Basic"],optional:!0}),i.prototype.publish("tbodySelectedRowFontColor",null,"html-color","Table body selected row color",null,{tags:["Basic"],optional:!0}),i.prototype.publish("tbodySelectedRowBackgroundColor",null,"html-color","Table body selected row color",null,{tags:["Basic"],optional:!0}),i.prototype.publish("tableZebraColor",null,"html-color","Table zebra row color",null,{tags:["Basic"],optional:!0}),i.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);return arguments.length&&(this._currentSort="",this._currentSortOrder=1),n},i.prototype.size=function(e){var n=t.prototype.size.apply(this,arguments);return arguments.length&&this.tableDiv&&(this.tableDiv.style("width",this._size.width+"px").style("height",this._size.height+"px"),this.headerDiv.style("width",this._size.width+"px").style("height",this._size.height+"px")),n},i.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._parentElement.style("overflow","hidden"),this.tableDiv=n.append("div").attr("class","tableDiv"),this.table=this.tableDiv.append("table"),this.thead=this.table.append("thead").append("tr"),this.tbody=this.table.append("tbody"),this.headerDiv=n,this.tableDiv.style("overflow","auto").style("width",this.width()+"px").style("height",this.height()+"px"),this.headerDiv.style("width",this.width()+"px").style("height",this.height()+"px")},i.prototype._generateTempRow=function(){var e=this.tbody.append("tr");return e.append("td").text("QQQ"),e},i.prototype._createSelectionObject=function(e){var t=this;return{_id:e,element:function(){return t.tbody.selectAll("tr").filter(function(t){return t===e})}}},i.prototype._calcRowsPerPage=function(e){this._paginator.numItems()===0&&(this._paginator.numItems(1),this.itemsPerPage(1)),this._paginator.render();var t=this.thead.selectAll("th").node().clientHeight,n=this._generateTempRow(),r=n.node().clientHeight;n.remove();var i=this.calcHeight(this._paginator.element()),s=Math.floor((this.height()-t-i-(this.hasHScroll(this.tableDiv)?this.getScrollbarWidth():0)-this._paginatorTableSpacing*2)/r)||1;return s},i.prototype.update=function(n,r){t.prototype.update.apply(this,arguments);var i=this,s=e.select(".tableDiv > table").node().getBoundingClientRect();this.fixedSize()&&s.width!==0&&s.height!==0?r.attr({width:s.width+"px",height:s.height+"px"}):r.attr({width:"100%",height:"100%"}),this.showHeader()||this.fixedHeader(!1);var o=this.thead.selectAll("th").data(this.showHeader()?this.columns():[],function(e){return e});o.enter().append("th").each(function(t){var n=e.select(this);n.append("span").attr("class","thText"),n.append("span").attr("class","thIcon")}).on("click",function(e,t){i.headerClick(e,t)}),o.style("background-color",this.theadRowBackgroundColor()).style("border-color",this.theadCellBorderColor()).style("color",this.theadFontColor()).style("font-size",this.theadFontSize()),o.select(".thText").style("font-family",this.theadFontFamily()).text(function(e){return e}),o.select(".thIcon").text(function(e,t){return i._currentSortOrder===-1?i._currentSort===t?"":"":i._currentSort===t?"":""}),o.exit().remove(),o.order();if(this.pagination()){this._paginator.target()===null&&this._paginator.target(r.node());var u=this._calcRowsPerPage(o);this.itemsPerPage(u),this._paginator.numItems(this.data().length),this._tNumPages=Math.ceil(this._paginator.numItems()/this.itemsPerPage())||1,(this.pageNumber()>this._tNumPages||this.pageNumber()<=0)&&this.pageNumber(1),this._paginator._onSelect=function(e,t){i.pageNumber(e),i.render();return},this.tableDiv.style("overflow-y","hidden")}else this.tableDiv.style("overflow-y",null),this._paginator.numItems(0);var a=this.pageNumber()-1,f=this.itemsPerPage(),l=a*f,c=parseInt(a*f)+parseInt(f),h=null;this.pagination()?h=this.data().slice(l,c):h=this.data();var p=this.tbody.selectAll("tr").data(h);p.enter().append("tr").on("click.selectionBag",function(e,t){i.selectionBagClick(e),i.render();var n=i.headerDiv.selectAll(".rows-wrapper tbody tr").filter(function(e,n){return n===t}),r=i.table.selectAll("tbody tr").filter(function(e,n){return n===t});r.classed("hover",!0),i.applyRowStyles(r),i.applyFirstColRowStyles(n)}).on("click",function(t){i.click(i.rowToObj(t),null,i._selectionBag.isSelected(i._createSelectionObject(t))),i.applyRowStyles(e.select(this))}).on("mouseover",function(e,t){var n=i.headerDiv.selectAll(".rows-wrapper tbody tr").filter(function(e,n){return n===t});if(n.empty())return;n.classed("hover",!0);var r=i.table.selectAll("tbody tr").filter(function(e,n){return n===t});r.classed("hover",!0),r.classed("selected")&&n.classed("selected",!0),i.applyStyleToRows(r),i.applyFirstColRowStyles(n)}).on("mouseout",function(e,t){var n=i.headerDiv.selectAll(".rows-wrapper tbody tr").filter(function(e,n){return n===t});n.classed("hover",!1);var r=i.table.selectAll("tbody tr").filter(function(e,n){return n===t}).classed("hover",!1);i.applyStyleToRows(r),i.applyFirstColRowStyles(n)}),p.attr("class",function(e){if(i._selectionBag.isSelected(i._createSelectionObject(e)))return"selected"}),p.exit().remove(),p.each(function(){var t=e.select(this);i.applyStyleToRows(t)});var d=p.selectAll("td").data(function(e,t){return e});d.enter().append("td"),d[this.renderHtmlDataCells()?"html":"text"](function(e){return typeof e=="string"?e.trim():typeof e=="number"?e:""}),d.exit().remove(),this._paginator.render(),this.data().length&&this.fixedLabelsUpdate(n,r),i.applyStyleToRows(this.tbody.selectAll("tr")),this._paginator.right((this.hasVScroll(this.tableDiv)?this.getScrollbarWidth():0)+this._paginatorTableSpacing).bottom((this.hasHScroll(this.tableDiv)?this.getScrollbarWidth():0)+this._paginatorTableSpacing).render()},i.prototype.fixedLabelsUpdate=function(t,n){function m(){var p=n.selectAll("th");p.style("border-color",r.theadCellBorderColor());if(r.fixedHeader()){u.html(l.html()),o.style("width",r.table.style("width"));var d=r._parentElement.selectAll(".cols-wrapper th");p.each(function(t,n){var r=d.filter(function(e,t){return t===n}),i=e.select(this).style("width");r.style("width",i)}),d.on("click",function(e,t){r.headerClick(e,t)}),f.html("")}var v,m;if(r.fixedColumn()){f.html("");var g=parseInt(r.table.select("td").style("border-width")),y=r.table.selectAll("tbody > tr > td:first-child");v=r.fixedColumn()?y.node().offsetWidth:0;var b=parseInt(v)+parseInt(2*g),w=f.selectAll("thead").data([0]);if(r.showHeader()){var E=w.enter().insert("thead","tbody").append("tr").style("background-color",r.theadRowBackgroundColor());w.exit().remove();var S=E.selectAll("th").data(p.filter(function(e,t){return t===0}));S.attr("class","update"),S.enter().append("th").html(function(e,t){return e[t].innerHTML}),S.style("width",b+"px").style("color",r.theadFontColor()).style("font-size",r.theadFontSize()).style("font-family",r.theadFontFamily()).style("border-color",r.theadCellBorderColor()),S.exit().remove()}var x=f.selectAll("tbody").data([0]);x.enter().append("tbody"),x.exit().remove();var T=x.selectAll("tr").data(y[0]);T.enter().append("tr").each(function(){var t=e.select(this);t.append("td").html(function(e){return e.innerHTML||"&nbsp;"})}),T.style("color",r.tbodyFontColor()).style("font-size",r.tbodyFontSize()).style("font-family",r.tbodyFontFamily()).style("border-color",r.tbodyCellBorderColor()),f.style("width",v),r.fixedHeader()?(w.style("position","absolute").style("width",b+"px"),f.style("margin-top",-t.scrollTop+c+"px"),n.style("top",c+"px")):r.showHeader()?(w.style("margin-top","0px").style("position","relative"),f.style("margin-top",-t.scrollTop+"px"),n.style("top","0px")):w.remove();var N=f.selectAll("tr");N.on("click",function(t,n){e.select(i[0][n]).on("click.selectionBag")(i.data()[n-1],n-1)}).on("mouseover",function(t,n){e.select(i[0][n]).on("mouseover")(i.data()[n-1],n-1)}).on("mouseout",function(t,n){e.select(i[0][n]).on("mouseout")(i.data()[n-1],n-1)}).attr("class",function(t,n){var s=r.showHeader()?1:0;if(i[0][n-s]&&e.select(i[0][n-s]).classed("selected")===!0)return i[0][n-s].parentElement.querySelector(":hover")===i[0][n-s]?"selected hover":"selected"})}else v=0;r.showHeader()||(h=0),m=parseInt(r.headerDiv.node().style.height)-parseInt(h);var C=parseInt(r.headerDiv.node().style.width)-parseInt(v),k=r.table.node().offsetWidth-v+r.getScrollbarWidth(),L=C>k?k:C;r.tableDiv.style("width",L+"px").style("height",m+"px").style("position","absolute").style("top",h+"px").style("left",v+"px").style("overflow","auto"),r.table.style("margin-left","-"+v+"px").style("margin-top","-"+c+"px"),s.style("position","absolute"),a.style("width",v+"px").style("position","absolute"),f.style("margin-top",-r.tableDiv.node().scrollTop+h+"px"),f.select("thead").style("margin-top",r.tableDiv.node().scrollTop-h+"px").on("click",function(e,t){r.headerClick(e,t)})}function g(e){e.onscroll=function(e){var t=e.target.scrollLeft,n=e.target.scrollTop;o.style("margin-left",-t+"px"),f.style("margin-top",-n+h+"px"),f.select("thead").style("margin-top",n-h+"px")}}var r=this,i=this.tbody.selectAll("tr");i.selectAll("td").style("color",this.tbodyFontColor()).style("font-size",this.tbodyFontSize()).style("font-family",this.tbodyFontFamily()).style("border-color",this.tbodyCellBorderColor());var s=this.headerDiv.selectAll(".cols-wrapper").data(this.fixedHeader()?[0]:[]);s.enter().insert("div",".rows-wrapper").attr("class","cols-wrapper").each(function(t){var n=e.select(this);n.append("table").classed("labels-wrapper",!0).append("thead")}),s.exit().remove();var o=s.select(".labels-wrapper"),u=s.select(".labels-wrapper > thead"),a=this.headerDiv.selectAll(".rows-wrapper").data(this.fixedColumn()?[0]:[]);a.enter().append("div").attr("class","rows-wrapper").each(function(t){var n=e.select(this);n.append("table").classed("labels-wrapper",!0)}),a.exit().remove();var f=a.select(".labels-wrapper"),l=this.table.select("thead"),c=this.fixedHeader()||!this.showHeader()?l.node().offsetHeight:0,h=c;m(this._id),g(this.tableDiv.node());var p=s.selectAll(".labels-wrapper tr"),d=a.selectAll(".labels-wrapper tbody > tr"),v=a.selectAll(".labels-wrapper thead > tr");p.style("background-color",this.theadRowBackgroundColor()),v.style("background-color",this.theadRowBackgroundColor()),r.applyFirstColRowStyles(d),setTimeout(function(){r.applyStyleToRows(r.tbody.selectAll("tr"))},0)},i.prototype.exit=function(e,n){this._paginator.target(null),t.prototype.exit.apply(this,arguments)},i.prototype.sort=function(e){this._currentSort!==e?(this._currentSort=e,this._currentSortOrder=1):this._currentSortOrder*=-1;var t=this;return this.data().sort(function(n,r){return n[e]===r[e]?0:typeof r[e]=="undefined"||n[e]>r[e]?t._currentSortOrder:t._currentSortOrder*-1}),this},i.prototype.headerClick=function(e,t){this.sort(t).render()},i.prototype.selection=function(e){return arguments.length?(this._selectionBag.set(e.map(function(e){return this._createSelectionObject(e)},this)),this):this._selectionBag.get().map(function(e){return e._id})},i.prototype.selectionBagClick=function(t){if(e.event.shiftKey){var n=!1,r=[],i=this.data().filter(function(e,i){var s=!1;if(e===t||e===this._selectionPrevClick)n&&(s=!0),n=!n,r.push(i);return n||s},this);return this.selection(i),r}this._selectionBag.click(this._createSelectionObject(t),e.event),this._selectionPrevClick=t},i.prototype.applyHoverRowStyles=function(e){var t=this;e.style("color",t.tbodyHoverRowFontColor()).style("background-color",t.tbodyHoverRowBackgroundColor())},i.prototype.applySelectedRowStyles=function(e){var t=this;e.style("color",t.tbodySelectedRowFontColor()).style("background-color",t.tbodySelectedRowBackgroundColor())},i.prototype.applyRowStyles=function(e,t){e.style("color",t?this.tbodyFirstColFontColor():this.tbodyFontColor()).style("background-color",t?this.tbodyFirstColBackgroundColor():this.tableZebraColor_exists()&&this.data().indexOf(e.datum())%2?this.tbodyRowBackgroundColor():this.tableZebraColor())},i.prototype.applyFirstColRowStyles=function(e){this.applyStyleToRows(e,!0)},i.prototype.applyStyleToRows=function(t,n){n=typeof n!="undefined"?n:!1;var r=this;t.each(function(){var t=e.select(this);t.classed("hover")?r.applyHoverRowStyles(t):t.classed("selected")?r.applySelectedRowStyles(t):r.applyRowStyles(t,n)})},i.prototype.click=function(e,t){console.log("Click:  "+JSON.stringify(e)+", "+t)},i}),function(e,t){typeof define=="function"&&define.amd?define("other/Legend.js",["d3","./Table","css!./Legend"],t):e.other_Legend=t(e.d3,e.other_Table)}(this,function(e,t){function n(){t.call(this),this._tag="div",this.showHeader(!1)}return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.prototype._class+=" other_Legend",n.prototype.targetWidget=function(e){function v(e){return'<div class="colorBlock" style="background-color:'+e+';"></div>'}function m(e){var t=e.toString().split(".")[0],n=e.toString().split(".")[1];while(/(\d+)(\d{3})/.test(t.toString()))t=t.toString().replace(/(\d+)(\d{3})/,"$1,$2");return typeof n!="undefined"?t+"."+n:t}var t=this,n=["Key","Label"],r=[],i=e.columns(),s=e._palette.toString().split("function ")[1].split("(")[0];if(s==="ordinal")for(var o in i)o>0&&r.push([v(e._palette(i[o])),i[o]]);else if(s==="rainbow"){var u=e._palette.colors().reverse(),a=u.length,f=e._dataMinWeight,l=e._dataMaxWeight;for(var c=0;c<a;c++){var h=parseInt((l-f)/a),p,d;c===0?(d=m(f+h*(c+1)),r.push([v(u[c]),"0 - "+d])):c+1===a?(p=m(f+h*c+1),r.push([v(u[c]),p+"+"])):(p=m(f+h*c+1),d=m(f+h*(c+1)),r.push([v(u[c]),p+" - "+d]))}}return t.columns(n),t.data(r),t._targetWidget=e,this},n.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this.renderHtmlDataCells(!0),this.fixedHeader(!1),n.classed("other_Legend",!0)},n.prototype.update=function(e,n){t.prototype.update.apply(this,arguments);var r=this;typeof this._targetWidget!="undefined"&&this.targetWidget(this._targetWidget);var i=n.select(".tableDiv > table"),s=i.node().getBoundingClientRect(),o=this._parentElement.node().getBoundingClientRect();n.select(".tableDiv").style({overflow:"visible"});var u=o.height/2-s.height/2,a=o.width/2-s.width/2;i.style({position:"absolute",top:u+"px",left:a+"px"});var f=this.pageNumber()-1,l=this.itemsPerPage(),c=f*l,h=parseInt(f*l)+parseInt(l),p=null;this.pagination()?p=this.data().slice(c,h):p=this.data();var d=this.tbody.selectAll("tr").data(p);d.on("click",function(e,t){r.onClick(e,t)}).on("mouseover",function(e,t){r.onMouseOver(e,t)})},n.prototype.onClick=function(e,t){console.log("Legend onClick method"),console.log("rowData: "+e),console.log("rowIdx: "+t)},n.prototype.onMouseOver=function(e,t){console.log("Legend onMouseOver method"),console.log("rowData: "+e),console.log("rowIdx: "+t)},n}),function(e,t){typeof define=="function"&&define.amd?define("other/MorphText.js",["../common/SVGWidget","css!./MorphText"],t):e.other_MorphText=t(e.common_SVGWidget)}(this,function(e){function t(){e.call(this)}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype._class+=" other_MorphText",t.prototype.publish("anchor","middle","set","Sets anchor point",["middle"],{tags:["Basic"]}),t.prototype.publish("fontSize",14,"number","Sets fontsize",null,{tags:["Basic"]}),t.prototype.publish("reverse",!1,"boolean","Reverse Animation",null,{tags:["Basic"]}),t.prototype.publish("text","","string","Sets text/data of widget",null,{tags:["Basic"]}),t.prototype._origText=t.prototype.text,t.prototype.text=function(e){var n=t.prototype._origText.apply(this,arguments);if(arguments.length){var r={},i=e.split("");this.data(i.map(function(e){var t="_"+e;return r[t]===undefined&&(r[t]=0),r[t]++,{text:e,id:e.charCodeAt(0)+1024*r[t]}}))}return n},t.prototype.enter=function(e,t){if(!this.fontSize()){var n=window.getComputedStyle(e,null);this.fontSize(parseInt(n.fontSize))}this._fontWidth=this.fontSize()*32/48,this._textElement=t.append("g")},t.prototype.dateTime=function(){var e=new Date,t=e.getSeconds().toString().length===1?"0"+e.getSeconds():e.getSeconds(),n=e.getMinutes().toString().length===1?"0"+e.getMinutes():e.getMinutes(),r=e.getHours().toString().length===1?"0"+e.getHours():e.getHours(),i=e.getHours()>=12?"pm":"am",s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],o=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return o[e.getDay()]+" "+s[e.getMonth()]+" "+e.getDate()+" "+e.getFullYear()+" "+r+":"+n+":"+t+i},t.prototype.update=function(e,t){var n=this,r=this._textElement.selectAll("text").data(this.data(),function(e){return e.id});r.attr("class","update"),this.transition.apply(r).attr("x",function(e,t){return(-n.data().length/2+t)*n._fontWidth+n._fontWidth/2});var i=r.enter().append("text").attr("class","enter").attr("font-size",this.fontSize()).attr("dy",".35em").attr("y",(this.reverse()?1:-1)*this._fontWidth*2).attr("x",function(e,t){return(-n.data().length/2+t)*n._fontWidth+n._fontWidth/2}).style("fill-opacity",1e-6).style("text-anchor",this.anchor()).text(function(e){return e.text});this.transition.apply(i).attr("y",0).style("fill-opacity",1),r.exit().attr("class","exit"),this.transition.apply(r.exit()).attr("y",(this.reverse()?-1:1)*this._fontWidth*2).style("fill-opacity",1e-6).remove()},t}),function(e,t){typeof define=="function"&&define.amd?define("other/Persist",["require"],t):e.other_Persist=t(e.require)}(this,function(e){function t(e){var t=[],n=e._id===undefined;for(var r in e)if(r.indexOf("__meta_")>=0){var i=e,s=i[r];if(s.type)if(!n||s.type!=="proxy"){while(s.type==="proxy")i=i[s.proxy],s=i["__meta_"+s.method];s.id!==e[r].id&&(s=JSON.parse(JSON.stringify(s)),s.id=e[r].id),t.push(s)}}return t}function n(e,r){if(!e)return;r(e);var i=t(e);for(var s=0;s<i.length;++s){var o=i[s];switch(o.type){case"widget":n(e[o.id](),r);break;case"widgetArray":var u=e[o.id]();u.forEach(function(e){n(e,r)})}}}function r(e,n,r){var i=t(e);for(var s=0;s<i.length;++s){var o=i[s];(typeof n!="function"||!n(e,o))&&r(e,o)}}function i(e,t,i){n(e,function(e){r(e,t,i)})}return{discover:t,widgetWalker:n,propertyWalker:r,widgetPropertyWalker:i,serializeTheme:function(e,t){return JSON.stringify(this.serializeThemeToObject(e,t))},serializeThemeToObject:function(e,t){function r(e,t){var n=!1;for(var r in t)if(e.indexOf(t[r])!==-1){n=!0;break}return n}t=t||["surface","Color","Font","palette"];var n={};return i(e,null,function(e,i){if(e[i.id+"_modified"]()||e["__meta_"+i.id].origDefaultValue!==e["__meta_"+i.id].defaultValue)if(r(i.id,t)){var s=e._class.trim().split(" ");for(var o in s){n[s[o]]===undefined&&(n[s[o]]={});if(n[s[o]][i.id]===undefined){n[s[o]][i.id]=e[i.id]();break}if(n[s[o]][i.id]===e[i.id]())break}}}),n},removeTheme:function(e,t){i(e,null,function(e,t){e["__meta_"+t.id].defaultValue=e["__meta_"+t.id].origDefaultValue}),typeof t=="function"&&t.call(this)},applyTheme:function(e,t,n){var r=this;i(e,null,function(e,n){switch(n.type){case"widget":return r.applyTheme(e[n.id](),t),!0;case"widgetArray":var i=e[n.id]();return i.forEach(function(e){r.applyTheme(e,t)},this),!0;default:e.applyTheme(t)}}),typeof n=="function"&&n.call(this)},serializeToObject:function(e,t,n){var i={__version:3,__class:e.classID(),__properties:{}};e._id.indexOf("_w")!==0&&(i.__id=e._id);var s=this;r(e,t,function(e,t){if(e[t.id+"_modified"]())switch(t.type){case"widget":return i.__properties[t.id]=s.serializeToObject(e[t.id](),null,n),!0;case"widgetArray":i.__properties[t.id]=[];var r=e[t.id]();return r.forEach(function(e,r){i.__properties[t.id].push(s.serializeToObject(e,null,n))}),!0;default:i.__properties[t.id]=e[t.id]()}});if(e.classID()==="marshaller_Graph"){var o=e.data().vertices;o&&(this.__vertices=o.map(function(e){return this.serializeToObject(e,null,n)},this))}return n&&(i.__data={},i.__data.columns=e.columns(),i.__data.data=e.data()),i},serialize:function(e,t,n){return JSON.stringify(this.serializeToObject(e,t,n))},deserializeFromObject:function(e,t,n){var r=0,s=this;i(e,null,function(e,n){e[n.id+"_reset"]();if(t.__properties[n.id]!==undefined)switch(n.type){case"widget":++r;var i=n.id;s.create(t.__properties[n.id],function(t){e[i](t),--r});break;case"widgetArray":++r;var o=n.id,u=t.__properties[n.id],a=[];a.length=u.length;var f=0;u.forEach(function(t,n){++f,s.create(t,function(e){a[n]=e,--f});var i=setInterval(function(){f<=0&&(clearInterval(i),f=undefined,e[o](a),--r)},20)});break;default:e[n.id](t.__properties[n.id])}});var o=setInterval(function(){if(r<=0){clearInterval(o),r=undefined;if(t.__data)for(var i in t.__data)e[i](t.__data[i]);n(e)}},20)},deserialize:function(e,t,n){typeof t=="string"&&(t=JSON.parse(t)),t.__id&&t.__id.indexOf("_w")!==0&&e._id!==t.__id&&console.log("Deserialize:  IDs do not match - "+e._id),this.deserializeFromObject(e,t,n)},create:function(t,n){typeof t=="string"&&(t=JSON.parse(t));var r="src/"+t.__class.split("_").join("/"),i=this;e([r],function(e){var r=new e;t.__id&&t.__id.indexOf("_w")!==0&&(r._id=t.__id),i.deserializeFromObject(r,t,n)})},clone:function(e,t){this.create(this.serializeToObject(e,[],!0),t)}}}),function(e,t){typeof define=="function"&&define.amd?define("other/PropertyEditor",["d3","../common/Widget","../common/HTMLWidget","./Persist","../layout/Grid","../layout/Accordion","../form/Form","../form/Input","css!./PropertyEditor"],t):e.other_PropertyEditor=t(e.d3,e.common_Widget,e.common_HTMLWidget,e.other_Persist,e.layout_Grid,e.layout_Accordion,e.form_Form,e.form_Input)}(this,function(e,t,n,r,i,s,o,u){function a(){n.call(this),this._tag="div",this._columns=["Key","Value"],this._contentEditors=[],this._show_settings=!0,this._dataDiv={},this._previousIds=""}return a.prototype=Object.create(s.prototype),a.prototype.constructor=a,a.prototype._class+=" other_PropertyEditor",a.prototype.publish("showColumns",!1,"boolean","Show Columns",null,{tags:["Intermediate"]}),a.prototype.publish("showData",!1,"boolean","Show Data",null,{tags:["Intermediate"]}),a.prototype.publish("paramsBeforeWidgets",!0,"boolean","The non-widget parameter collapsible is placed before widget section(s)",null,{tags:["Private"]}),a.prototype.publish("paramGrouping","By Widget","set","Param Grouping",["By Param","By Widget"],{tags:["Basic"]}),a.prototype.publish("excludeTags",[],"array","Array of publish parameter tags to exclude from PropertEditor",null,{tags:["Private"]}),a.prototype.publish("showProperties",[],"array","Array of publish parameter IDs to include in PropertEditor (all others will be excluded)",null,{tags:["Private"]}),a.prototype.publish("settingsWidget",null,"widget","Another instance of PropertyEditor containing the publish parameters for the main instance of PropertyEditor",null,{tags:["Private"]}),a.prototype.publish("ignoredClasses",[],"array","Array of class chain substrings to hide params on match",null,{tags:["Basic"]}),a.prototype.data=function(e){var t=n.prototype.data.apply(this,arguments);if(arguments.length){var r=this;e[0]instanceof i&&(e[0].postSelectionChange=function(){var t=e[0]._selectionBag.get().map(function(e){return e.widget});r.data(t.length>0?t:[e[0]]).paramGrouping(t.length>1?"By Param":"By Widget").render()})}return t},a.prototype.show_settings=function(e){return arguments.length?(this._show_settings=e,this):this._show_settings},a.prototype.excludeWidgets=function(e){return arguments.length?(this._excludeWidgets=e,this):this._excludeWidgets},a.prototype.onChange=function(e,t){},a.prototype.paramFilter=function(){var e=this.showProperties(),t=this.excludeTags();return function(n,r){var i=e;if(i.length>0&&i.indexOf(r.id)===-1)return!0;if(t.length>0&&typeof r.ext=="object"&&typeof r.ext.tags=="object")for(var s in r.ext.tags)if(t.indexOf(r.ext.tags[s])!==-1)return!0;return!1}},a.prototype.enter=function(e,t){s.prototype.enter.apply(this,arguments),this._parentElement.filter(".other_PropertyEditor div").empty()&&this._parentElement.style("overflow","auto"),this.title()===""&&this.title("Property Editor"),this.show_settings()&&this.pushListItem((new a).showColumns(!1).showData(!1).show_settings(!1).excludeWidgets(!0).defaultCollapsed(!0).excludeTags(["Private"]).paramGrouping("By Widget").title("Editor Settings").data([this]),null,!0)},a.prototype.update=function(e,t){var n=this;switch(this.paramGrouping()){case"By Param":var i=this.getAllParams();this.clearListItems(),this.removeWatches();for(var u in this.data())this.createWatch(this.data()[u]);var f=this.categorizeParams(i);for(var l in f){var c=[];for(var h in f[l]){var p=f[l][h];c.push(this.getSharedParamInputObj(p))}this.pushListItem((new s).title(l+":").pushListItem((new o).showSubmit(!1).inputs(c)))}break;case"By Widget":this.clearListItems(),this.removeWatches();for(var d=0;d<this.data().length;d++){this.createWatch(this.data()[d]);var v=[],m=this.data()[d]._class.split("_").pop();r.propertyWalker(this.data()[d],n.paramFilter(),function(e,t){switch(t.type){case"widget":if(!n.excludeWidgets()){var r=e[t.id]()._class.split("_").pop();n.pushListItem((new a).showData(n.showData()).showColumns(n.showColumns()).show_settings(!1).title(r).data([e[t.id]()]).ignoredClasses(n.ignoredClasses()))}break;case"widgetArray":if(!n.excludeWidgets()){var i=e[t.id](),s=[];for(var o=0;o<i.length;o++)s.push(i[o]._class.split("_").pop());n.pushListItem((new a).show_settings(!1).title(m+"."+t.id+": ["+s.join(", ")+"]").data(i).ignoredClasses(n.ignoredClasses()))}break;default:v.push(n.getParamInputObj(e,t))}}),this.showData()&&v.push(this.getDataInputObj(this.data()[d])),this.showColumns()&&v.push(this.getColumnsInputObj(this.data()[d]));if(v.length>0&&this.classIsNotHidden(this.data()[d]._class)){var g;this.excludeWidgets()?(this.clearListItems(),g=(new o).showSubmit(!1).inputs(v)):this.content().length>0?g=(new s).title(m+" Params:").pushListItem((new o).showSubmit(!1).inputs(v)):g=(new o).showSubmit(!1).inputs(v),this.pushListItem(g,this.paramsBeforeWidgets())}}}s.prototype.update.apply(this,arguments)},a.prototype.exit=function(e,t){n.prototype.exit.apply(this,arguments)},a.prototype.removeWatches=function(){for(var e in this.__propertyEditor_watch)typeof this.__propertyEditor_watch[e].remove=="function"&&this.__propertyEditor_watch[e].remove();this.__propertyEditor_watch=[]},a.prototype.createWatch=function(e){var t=this;this.__propertyEditor_watch.push(e.watch(function(e,n){typeof n=="object"&&t.render()}))},a.prototype.categorizeParams=function(e){var t={Colors:["palette","color"],Font:["font"],Axis:["axis"],General:[]},n={};for(var r in e){for(var i in t)if(r.toLowerCase().indexOf(t[i])!==-1)break;typeof n[i]=="undefined"&&(n[i]=[]),n[i].push(e[r])}return n},a.prototype.classIsNotHidden=function(e){var t=this.ignoredClasses();for(var n in t)if(e.indexOf(t[n])!==-1)return!1;return!0},a.prototype.getAllParams=function(){var e=this,t={};for(var n in this.data())r.widgetPropertyWalker(this.data()[n],e.paramFilter(),function(e,n){switch(n.type){case"widget":case"widgetArray":break;default:typeof t[n.id]=="undefined"&&(t[n.id]=[]),t[n.id].push({widget:e,param:n})}});return t},a.prototype.getParamInputObj=function(e,t){var n=["widget","widgetArray"].indexOf(t.type)===-1?e[t.id]():null,r=(new u).name(e._id+"-"+t.id).label(t.id).type(this.inputTypeMapping(t.type)).value(n);return t.type==="set"&&r.selectOptions(t.set).value(n),r.change=function(n){if(t.type==="boolean")e[t.id](n._element.select("input").property("checked")).render();else if(t.type==="array"){var r=n.value().split(",").filter(function(e){return e.length});e[t.id](r).render()}else e[t.id](n.value()).render()},r._paramId=t.id,r},a.prototype.getSharedParamInputObj=function(e){var t=e[0].param.id,n=e[0].param.type,r=(new u).name(t).label(t).type(this.inputTypeMapping(n));return n==="set"&&r.selectOptions(e[0].param.set),r.change=function(r){for(var i in e)if(n==="boolean")e[i].widget[t](r._element.select("input").property("checked")).render();else if(n==="array"){var s=r.value().split(",").filter(function(e){return e.length});e[i].widget[t](s).render()}else e[i].widget[t](r.value()).render()},r._paramId=t,r},a.prototype.getDataInputObj=function(e){var t="";try{t=JSON.stringify(e.data())}catch(n){}var r=(new u).name(e._id+"-data").label("Data").type("textarea").value(t);return r.change=function(t){try{e.data(JSON.parse(t.value())).render()}catch(n){}},r},a.prototype.getColumnsInputObj=function(e){var t=(new u).name(e._id+"-columns").label("Columns").type("textarea").value(e.columns());return t.change=function(t){e.columns(t.value().split(",")).render()},t},a.prototype.inputTypeMapping=function(e){switch(e){case"set":return"select";case"array":return"textarea";case"boolean":return"checkbox";case"string":return"text";default:return e}},a.prototype.click=function(e){},a}),function(e,t){typeof define=="function"&&define.amd?define("other/ThemeEditor.js",["../common/Widget","../common/HTMLWidget","./Persist","./PropertyEditor","css!./ThemeEditor"],t):e.other_PropertyEditor=t(e.common_Widget,e.common_HTMLWidget,e.other_Persist,e.other_PropertyEditor)}(this,function(e,t,n,r){function i(){t.call(this),this._tag="div",this._current_grouping=undefined,this._showing_columns=undefined,this._showing_data=undefined,this.columns(["Key","Value"]),this._contentEditors=[],this._showSettings=!0,this._defaultThemes=[],this._widgetObjsById={}}function l(e){var t=e.split(/(?=[0-9A-Z])/).map(function(e){return e.length>1?e+" ":e}).join("");return t.replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})}function c(e,t,n,r){function c(e,t){var n="";return e.set.forEach(function(e){var r=e===t?" selected":"";n+="<option value='"+e+"'"+r+">"+e+"</option>"}),n}var i="",s="te-input-"+e.id+"-"+r,o;typeof e.ext!="undefined"&&typeof e.ext.inputType!="undefined"&&(o=e.ext.inputType),typeof e.inputID!="undefined"&&(s=e.inputID);var u="data-paramid='"+e.id+"' data-wids='"+n.map(function(e){return typeof e.widget=="object"?e.widget._id:e}).join(",")+"'";switch(e.type){case"boolean":var a=t?" checked":"";i="<input id='"+s+"' "+u+" type='checkbox' class='te-checkbox te-input'"+a+">";break;case"number":typeof o!="undefined"?o==="textarea"?i="<textarea id='"+s+"' class='te-textarea te-input' "+u+">"+t+"</textarea>":o==="range"&&(i="<input id='"+s+"' class='te-input' type='range' "+u+" value='"+t+"'  min='"+e.ext.min+"' max='"+e.ext.max+"' step='"+e.ext.step+"'>"):i="<input id='"+s+"' type='text' class='te-text te-input' "+u+" value='"+t+"'>";break;case"string":typeof o!="undefined"?o==="textarea"&&(i="<textarea id='"+s+"' class='te-textarea te-input' "+u+">"+t+"</textarea>"):i="<input id='"+s+"' type='text' class='te-text te-input' value='"+t+"' "+u+">";break;case"html-color":var f=t===""?"":" value='"+t+"'";i="<input id='"+s+"' type='text' class='te-html-color-input te-input' "+u+" "+f+">",i+="<input type='color' class='te-html-color-button te-input' "+u+" "+f+">";break;case"set":var l=c(e,t);i="<select id='"+s+"' class='te-select te-input'"+u+">"+l+"</select>";break;case"array":i="<textarea id='"+s+"' class='te-textarea te-input' data-type='array' "+u+">"+t+"</textarea>";break;default:}return typeof e.ext.saveButton!="undefined"&&(i+="<button id='"+e.ext.saveButtonID+"'>"+e.ext.saveButton+"</button>"),i}var s=function(e){return typeof window.g_defaultThemes=="function"&&window.g_defaultThemes(e),JSON.parse(localStorage.getItem("themeEditorThemes")||"{}")},o=function(e){return typeof window.g_defaultSerials=="function"&&window.g_defaultSerials(e),JSON.parse(localStorage.getItem("themeEditorSerials")||"{}")},u=function(e){var t=s(),n=[];for(var r in t)n.push(r);return typeof e!="undefined"&&typeof n[e]!="undefined"&&(n=n[e]),n},a=function(e){var t=o(),n=[];for(var r in t)n.push(r);return typeof e!="undefined"&&typeof n[e]!="undefined"&&(n=n[e]),n};i.prototype=Object.create(t.prototype),i.prototype._class+=" other_ThemeEditor",i.prototype.publish("themeMode",!0,"boolean","Edit default values",null,{tags:["Basic"]}),i.prototype.publish("saveTheme","","string","Save Theme",null,{tags:["Basic","Theme"],saveButton:"Save",saveButtonID:"te-save-button"}),i.prototype.publish("loadedTheme",u(1),"set","Loaded Theme",u(),{tags:["Basic","Theme"]}),i.prototype.publish("saveSerial","","string","Save Serial",null,{tags:["Basic","Serial"],saveButton:"Save",saveButtonID:"te-save-button"}),i.prototype.publish("loadedSerial",a(0),"set","Loaded Serial",a(),{tags:["Basic","Serial"]}),i.prototype.publish("showColumns",!0,"boolean","Show Columns",null,{tags:["Intermediate"]}),i.prototype.publish("showData",!0,"boolean","Show Data",null,{tags:["Intermediate"]}),i.prototype.publish("shareCountMin",1,"number","Share Count Min",null,{tags:["Private"]}),i.prototype.publish("paramGrouping","By Param","set","Param Grouping",["By Param","By Widget"],{tags:["Private"]}),i.prototype.publish("editorComplexity","Basic","set","Choose what publish properties to display within the editor.",["Basic","Intermediate","Advanced","Private"],{tags:["Private"]}),i.prototype.publish("sectionTitle","","string","Section Title",null,{tags:["Private"]}),i.prototype.publish("collapsibleSections",!0,"boolean","Collapsible Sections",null,{tags:["Intermediate"]}),i.prototype.getThemes=s,i.prototype.getSerials=o,i.prototype.getDefaultThemes=u,i.prototype.getDefaultSerials=a,i.prototype.showSettings=function(e){return arguments.length?(this._showSettings=e,this):this._showSettings},i.prototype.onChange=function(e,t){},i.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._parentElement.style("overflow","auto")};var f=function(e){var t=!1;return typeof e._current_grouping=="undefined"?e._current_grouping=e._group_params_by:e._current_grouping!==e._group_params_by&&(t=!0),typeof e._showing_columns=="undefined"?e._showing_columns=e.showColumns():e._showing_columns!==e.showColumns()&&(t=!0),typeof e._showing_data=="undefined"?e._showing_data=e.showData():e._showing_data!==e.showData()&&(t=!0),t};return i.prototype.widgetProperty=function(e,t,n){return n===undefined?e[t]():e[t](n)},i.prototype.load=function(){},i.prototype.save=function(){},i.prototype.needsPropTableRedraw=function(e,t){var n=document.getElementById("te-themeEditorOptions")===null;return n},i.prototype.update=function(e,r){t.prototype.update.apply(this,arguments),f(this)&&r.selectAll("#"+this._id+" > table").remove(),this._current_grouping=this.paramGrouping(),this._widgetObjsById[this._id]=this,this._sharedProperties=this.findSharedProperties(this.data());var i=this.needsPropTableRedraw();if(i&&this.showSettings()){var s=n.discover(this);for(var o in s)if(s[o].ext.tags.indexOf(this.editorComplexity())!==-1){var u=this[s[o].id]();if(s[o].id==="loadedTheme"||s[o].id==="loadedSerial")s[o].inputID="te-load-theme";s[o].input=c(s[o],u,[this._id],this._id)}else delete s[o];e.innerHTML=this.propertiesTableHtml(s);var a=document.createEvent("Events");a.initEvent("TE Properties Ready",!0,!0),document.dispatchEvent(a)}this.buildTableObjects(e,this._sharedProperties),this.initFunctionality(e)},i.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},i.prototype.click=function(e){},i.prototype.propertiesTableHtml=function(e){var t={id:"te-themeEditorOptions",label:"Editor Options",rowArr:[]},n={id:"te-tableModeOptions",label:this.themeMode()?"Save/Load Theme":"Save/Load Serial",rowArr:[]};for(var r in e)this.themeMode()?e[r].ext.tags.indexOf("Theme")===-1&&e[r].ext.tags.indexOf("Serial")===-1?t.rowArr.push({th:l(e[r].id),td:e[r].input,trClass:"propertyRow"}):e[r].ext.tags.indexOf("Theme")!==-1&&n.rowArr.push({th:l(e[r].id),td:e[r].input,trClass:"propertyRow"}):e[r].ext.tags.indexOf("Serial")===-1&&e[r].ext.tags.indexOf("Theme")===-1?t.rowArr.push({th:l(e[r].id),td:e[r].input,trClass:"propertyRow"}):e[r].ext.tags.indexOf("Serial")!==-1&&n.rowArr.push({th:l(e[r].id),td:e[r].input,trClass:"propertyRow"});var i="";return t.rowArr.length>0&&(i+=this.tableObjHtml(t)),n.rowArr.length>0&&(i+=this.tableObjHtml(n)),i},i.prototype.buildTableObjects=function(e,t){var n={};this.themeMode()?n={chartColorSection:{id:"te-colorOptions",label:"Chart Colors",rowObjArr:[]},surfaceSection:{id:"te-containerOptions",label:"Container Styles/Colors",rowObjArr:[]},fontSection:{id:"te-fontOptions",label:"Font Styles/Colors",rowObjArr:[]}}:n={nonSurfaceSection:{id:"te-chartOptions",label:"Chart Properties",rowObjArr:[]}};for(var r in t)this.themeMode()?r.toUpperCase().indexOf("FONT")===-1||t[r].arr[0].widget._class.indexOf("layout_Surface")!==-1&&r.toUpperCase().indexOf("COLOR")!==-1?r==="paletteID"?n.chartColorSection.rowObjArr.push(t[r]):t[r].arr[0].widget._class.indexOf("layout_Surface")!==-1&&n.surfaceSection.rowObjArr.push(t[r]):n.fontSection.rowObjArr.push(t[r]):t[r].arr[0].widget._class.indexOf("layout_Surface")===-1&&n.nonSurfaceSection.rowObjArr.push(t[r]);var i="";for(var s in n)i+=this.sharedPropertyTableHtml(n[s]);e.innerHTML+=i},i.prototype.initFunctionality=function(e){function n(e){if(t.showSettings()){var n=document.getElementById("te-save-button");n.onclick=function(e){var n=e.srcElement,r=n.previousSibling.value;if(r.length>1){var i=document.getElementById("te-load-theme"),s=i.getElementsByTagName("option"),o=!1,u;for(var a in s){var f=s[a].value;f===r&&(o=!0)}if(!o)u=t.save(r),i.innerHTML+="<option value='"+r+"'>"+r+"</option>";else{var l=confirm("'"+r+"' already exists. Do you want to overwrite the existing save? ");l&&(u=t.save(r))}n.previousSibling.value="",i.value=r}else alert("Save Name cannot be empty.")}}}function r(e){var n=e.getElementsByClassName("te-input");for(var r in n){if(isNaN(parseInt(r)))break;var i=n[r],s=i.getAttribute("id");if(s==="te-load-theme")i.onchange=function(e){var n=e.srcElement;t.load(n.value)};else if(s!==null&&s.indexOf("te-input-themeMode")!==-1)i.onchange=function(e){var n=e.srcElement;t.themeMode(n.checked);var r=document.getElementById("te-load-theme"),i=r!==null?r.value:"Default";t.load(i)};else if(i.tagName==="INPUT"||i.tagName==="SELECT"||i.tagName==="TEXTAREA")i.onchange=function(e){var n=e.srcElement,r=n.getAttribute("id");n.className.split(" ").indexOf("te-html-color-button")!==-1&&(r=n.previousSibling.getAttribute("id"),n.previousSibling.value=n.value);var i=n.getAttribute("type"),s=r.split("-"),o=s.slice(0,s.length-1).join("-")+"-",u=n.getAttribute("data-wids"),a=n.getAttribute("data-paramid"),f=u.split(",");f.forEach(function(e){var r=o+e,s=document.getElementById(r);if(i==="checkbox")s.checked=n.checked,t._widgetObjsById[e][a](n.checked);else if(n.getAttribute("data-type")==="array"){s.value=n.value;try{t._widgetObjsById[e][a](JSON.parse(n.value))}catch(u){}}else s.value=n.value,t._widgetObjsById[e][a](n.value),s.className.split(" ").indexOf("te-html-color-input")!==-1?s.nextSibling.value=n.value:s.className.split(" ").indexOf("te-html-color-button")!==-1&&(s.previousSibling.value=n.value)}),t.data().forEach(function(e){e.render()})}}}function i(e){var t=e.getElementsByClassName("te-section-table");for(var n in t)if(typeof t[n].getElementsByTagName=="function"){var r=t[n].getElementsByTagName("thead");r[0].onclick=function(e){var t=e.toElement;t.tagName==="TH"&&(t=t.parentElement.parentElement);var n=t.parentElement,r="";n.className.split(" ").indexOf("expanded")===-1?(n.className="te-section-table expanded",r="shown"):(n.className="te-section-table collapsed",r="hidden");var i=n.getElementsByTagName("tbody");i[0].className=r}}var i=e.getElementsByClassName("sharedPropertyRow");for(var s in i)if(typeof i[s].getElementsByClassName=="function"){var o=i[s].getElementsByClassName("te-label");o[0].onclick=function(e){var t=e.toElement,n=t.parentElement,r="";n.className.split(" ").indexOf("expanded")===-1?(n.className="sharedPropertyRow expanded",r="shown"):(n.className="sharedPropertyRow collapsed",r="hidden");var i=n.nextSibling;while(i!==null)i.className.split(" ").indexOf("sharedPropertyRow")===-1?(i.className="propertyRow "+r,i=i.nextSibling):i=null}}}var t=this;i(e),r(e),n(e)},i.prototype.sharedPropertyTableHtml=function(e){function n(e){var t=e.widget.classID().split("_"),n=t.join("/");return n+" <i>["+e.widget._id+"]</i>"}function r(e){return l(e.id)}function i(e,t){function i(e,t){var n=e.arr[t].widget[e.id]();return n!==null?n:""}var n=i(e,t),r=c(e,n,[e.arr[t]],e.arr[t].widget._id);return r}function s(e){function r(e){var t=e.arr[0].widget[e.id]();return e.arr.forEach(function(e,n){if(t!==e.widget[e.id]())return""}),t!==null?e.type==="array"?JSON.stringify(t):t:""}var t=r(e),n=c(e,t,e.arr,"shared");return n}var t={id:e.id,label:e.label,rowArr:[]};return e.rowObjArr.forEach(function(e){e.arr.forEach(function(o,u){u===0&&t.rowArr.push({th:r(e),td:s(e),trClass:"sharedPropertyRow collapsed"}),t.rowArr.push({th:n(o),td:i(e,u),trClass:"propertyRow hidden"})})}),this.tableObjHtml(t)},i.prototype.tableObjHtml=function(e){var t="<table id='"+e.id+"' class='te-section-table expanded'>";return t+="<thead><tr><th colspan='2'>"+e.label+"</th></tr></thead>",t+="<tbody>",e.rowArr.forEach(function(e){t+=this.tableRowObjHtml(e)},this),t+="</tbody>",t+"</table>"},i.prototype.tableRowObjHtml=function(e){var t=typeof e.trClass!="undefined"?"<tr class='"+e.trClass+"'>":"<tr>";return t+="<th class='te-label'>"+e.th+"</th>",t+="<td>"+e.td+"</td>",t+"</tr>"},i.prototype.setWidgetObjsById=function(e){var t=this,n=e.widget[e.id]();e.type==="widgetArray"?n.forEach(function(e){t._widgetObjsById[e._id]=e}):e.type==="widget"&&n!==null&&(this._widgetObjsById[n._id]=n)},i.prototype.checkTagFilter=function(e){var t=["Basic"],n=!1;return e.forEach(function(e){t.indexOf(e)!==-1&&(n=!0)}),n},i.prototype.findSharedProperties=function(e){function u(e,r){var i=[];if(e!==null){var s=n.discover(e);s.forEach(function(n,s){typeof n.ext.tags!="undefined"&&i.push({id:n.id,type:n.type,description:n.description,set:n.set,ext:n.ext,widget:e});if(n.type==="widgetArray"){var o=t.widgetProperty(e,n.id);o.forEach(function(e){var t=u(e,r+1);i=i.concat(t)})}else if(n.type==="widget"){var a=t.widgetProperty(e,n.id),f=u(a,r+1);i=i.concat(f)}})}return i}var t=this,r;if(typeof e!="undefined"&&e.length>0){var i=[];r={};var s={},o={};e.forEach(function(e){var t=u(e,0);i=i.concat(t)}),i.forEach(function(e){if(["widget","widgetArray"].indexOf(e.type)!==-1)t.setWidgetObjsById(e);else if(t.checkTagFilter(e.ext.tags)){var n=e.id;e.widget._class.indexOf("Surface")!==-1?(typeof s[n]=="undefined"&&(s[n]={arr:[]}),s[n].id=e.id,s[n].description=e.description,s[n].type=e.type,s[n].set=e.set,s[n].ext=e.ext,s[n].arr.push(e)):(typeof o[n]=="undefined"&&(o[n]={arr:[]}),o[n].id=e.id,o[n].description=e.description,o[n].type=e.type,o[n].set=e.set,o[n].ext=e.ext,o[n].arr.push(e)),typeof r[n]=="undefined"&&(r[n]={arr:[]}),r[n].id=e.id,r[n].description=e.description,r[n].type=e.type,r[n].set=e.set,r[n].ext=e.ext,r[n].arr.push(e)}})}return r},i}),function(e,t){typeof define=="function"&&define.amd?define("other/WordCloud.js",["d3","../common/SVGWidget","./IWordCloud","d3-cloud","css!./WordCloud"],t):e.other_WordCloud=t(e.d3,e.common_SVGWidget,e.other_IWordCloud,e.d3.layout.cloud)}(this,function(e,t,n,r){function i(){t.call(this),n.call(this)}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" other_WordCloud",i.prototype.implements(n.prototype),i.prototype.publish("padding",1,"number","Padding",null,{tags:["Intermediate"]}),i.prototype.publish("fontFamily","Verdana","string","Font Name",null,{tags:["Basic"]}),i.prototype.publish("fontSizeFrom",6,"number","Font Size From",null,{tags:["Basic"]}),i.prototype.publish("fontSizeTo",24,"number","Font Size To",null,{tags:["Basic"]}),i.prototype.publish("angleFrom",-60,"number","Angle From",null,{tags:["Basic"]}),i.prototype.publish("angleTo",60,"number","Angle To",null,{tags:["Basic"]}),i.prototype.publish("angleCount",5,"number","Angle Count",null,{tags:["Basic"]}),i.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);return arguments.length&&(this._vizData=e.map(function(e){var t={};for(var n in e)t["__viz_"+n]=e[n];return t})),n},i.prototype.enter=function(t,n){this.cloud=(new r).font(this.fontFamily()).padding(this.padding()),this.zoomListener=e.behavior.zoom().scaleExtent([1,10]).on("zoom",function(){n.attr("transform","translate("+e.event.translate[0]+","+e.event.translate[1]+")"+"scale("+e.event.scale+")")}),this._parentElement.call(this.zoomListener)},i.prototype.update=function(t,n){function u(t,i){var o=e.scale.category20(),u=n.selectAll("text").data(t,function(e){return e.__viz_0?e.__viz_0.toLowerCase():""});u.transition().duration(1e3).attr("transform",function(e){return"translate("+[e.x,e.y]+")rotate("+e.rotate+")"}).style("font-size",function(e){return s(e.__viz_1)+"px"}).style("opacity",1),u.enter().append("text").attr("text-anchor","middle").attr("transform",function(e){return"translate("+[e.x,e.y]+")rotate("+e.rotate+")"}).style("font-size",function(e){return s(e.__viz_1)+"px"}).style("font-family",function(e){return e.fontFamily}).style("fill",function(e){return o(e.__viz_0?e.__viz_0.toLowerCase():"")}).text(function(e){return e.__viz_0}).on("click",function(e){r.click({label:e.__viz_0,weight:e.__viz_1})}).style("opacity",1e-6).transition().duration(1e3).style("opacity",1),u.exit().transition().duration(1e3).style("opacity",1e-4).remove();if(i){var a=r.width(),f=r.height(),l=i[1].x-i[0].x,c=i[1].y-i[0].y,h=.9/Math.max(l/a,c/f);n.transition().delay(1e3).duration(750).attr("transform","translate("+r._pos.x+","+r._pos.y+")scale("+h+")"),r.zoomListener.scale(h).translate([r._pos.x,r._pos.y])}}var r=this,i=e.extent(this._vizData,function(e){return e.__viz_1}),s=e.scale.log().domain(i).range([this.fontSizeFrom(),this.fontSizeTo()]),o=e.scale.linear().domain([0,r.angleCount()-1]).range([r.angleFrom(),r.angleTo()]);this.cloud.size([this.width(),this.height()]).words(this._vizData).rotate(function(){return o(~~(Math.random()*r.angleCount()))}).fontSize(function(e){return s(e.__viz_1)}).on("end",u).start()},i});